function q({d3:n,element:r,xScale:i,yScale:g,aspectRatio:l=null,scaleExtent:D=[.1,100],onChange:m=()=>{}}){const f=t=>typeof t.domain=="function"?t.domain():t.domain,b=t=>typeof t.range=="function"?t.range():t.range,y=f(i),w=f(g);function s(){return b(i)}function c(){return b(g)}function R(t,e){if(l==null)return[t,e];const E=s(),F=c(),k=Math.abs(E[1]-E[0]),B=Math.abs(F[1]-F[0]),H=(t[1]-t[0])*B/(k*l),L=(e[0]+e[1])/2,S=[L-H/2,L+H/2];return[t,S]}const x=[...y];let[a,o]=R([...y],[...w]);const z=new Float32Array(16),I=new Float32Array(16);function Y(){T(z,a[0],a[1],o[0],o[1],-1,1),Z(I,z)}Y();function A(){const[,t]=R([...x],[...w]);return t}const d=n.scaleLinear().domain(x).range(s()),p=n.scaleLinear().domain(A()).range(c());function h(){d.range(s()),p.domain(A()).range(c())}function X(){const t=(x[1]-x[0])/(a[1]-a[0]),e=d.range()[0]-t*d(a[0]),E=p.range()[0]-t*p(o[0]);return n.zoomIdentity.translate(e,E).scale(t)}function M(){const t=s(),e=c();return[[t[0],e[1]],[t[1],e[0]]]}const u=n.select(r).attr("id","zoom-target").style("cursor","grab"),v=n.zoom().scaleExtent(D).extent(M).on("start",()=>u.style("cursor","grabbing")).on("end",()=>u.style("cursor","grab")).on("zoom",t=>{h(),a=t.transform.rescaleX(d).domain(),o=t.transform.rescaleY(p).domain(),Y(),m({xDomain:a,yDomain:o,xRange:s(),yRange:c()})});return u.call(v).call(v.transform,n.zoomIdentity),{get xDomain(){return a},get yDomain(){return o},get xRange(){return s()},get yRange(){return c()},get view(){return z},get viewInverse(){return I},get xScale(){return d.copy().domain(a)},get yScale(){return p.copy().domain(o)},updateScales(t,e){i=t,g=e,h(),[a,o]=R(a,o);const E=X();u.call(v.transform,E),Y(),m({xDomain:a,yDomain:o,xRange:s(),yRange:c()})},reset(){h(),[a,o]=R([...x],[...w]),u.call(v.transform,n.zoomIdentity),Y(),m({xDomain:a,yDomain:o,xRange:s(),yRange:c()})}}}function T(n,r,i,g,l,D,m){const f=1/(r-i),b=1/(g-l),y=1/(D-m);return n[0]=-2*f,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*b,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*y,n[11]=0,n[12]=(r+i)*f,n[13]=(l+g)*b,n[14]=(m+D)*y,n[15]=1,n}function Z(n,r){const i=r[0],g=r[1],l=r[2],D=r[3],m=r[4],f=r[5],b=r[6],y=r[7],w=r[8],s=r[9],c=r[10],R=r[11],x=r[12],a=r[13],o=r[14],z=r[15],I=i*f-g*m,Y=i*b-l*m,A=i*y-D*m,d=g*b-l*f,p=g*y-D*f,h=l*y-D*b,X=w*a-s*x,M=w*o-c*x,u=w*z-R*x,v=s*o-c*a,W=s*z-R*a,t=c*z-R*o;let e=I*t-Y*W+A*v+d*u-p*M+h*X;return e?(e=1/e,n[0]=(f*t-b*W+y*v)*e,n[1]=(l*W-g*t-D*v)*e,n[2]=(a*h-o*p+z*d)*e,n[3]=(c*p-s*h-R*d)*e,n[4]=(b*u-m*t-y*M)*e,n[5]=(i*t-l*u+D*M)*e,n[6]=(o*A-x*h-z*Y)*e,n[7]=(w*h-c*A+R*Y)*e,n[8]=(m*W-f*u+y*X)*e,n[9]=(g*u-i*W-D*X)*e,n[10]=(x*p-a*A+z*I)*e,n[11]=(s*A-w*p-R*I)*e,n[12]=(f*M-m*v-b*X)*e,n[13]=(i*v-g*M+l*X)*e,n[14]=(a*Y-x*d-o*I)*e,n[15]=(w*d-s*Y+c*I)*e,n):null}export{q as createZoomableAxes};
