const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./inputs-DoHVubAa.js","./inputs-Cuu9vI3M.css","./demo-renderer-Cg2IeOer.js","./webgpu-instanced-lines.esm-DUY4_7kn.js"])))=>i.map(i=>d[i]);
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();const rt="modulepreload",ot=function(e,t){return new URL(e,t).href},Te={},f=function(t,n,i){let r=Promise.resolve();if(n&&n.length>0){let a=function(l){return Promise.all(l.map(c=>Promise.resolve(c).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};const s=document.getElementsByTagName("link"),d=document.querySelector("meta[property=csp-nonce]"),u=d?.nonce||d?.getAttribute("nonce");r=a(n.map(l=>{if(l=ot(l,i),l in Te)return;Te[l]=!0;const c=l.endsWith(".css"),p=c?'[rel="stylesheet"]':"";if(!!i)for(let y=s.length-1;y>=0;y--){const b=s[y];if(b.href===l&&(!c||b.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${p}`))return;const E=document.createElement("link");if(E.rel=c?"stylesheet":rt,c||(E.as="script"),E.crossOrigin="",E.href=l,u&&E.setAttribute("nonce",u),document.head.appendChild(E),c)return new Promise((y,b)=>{E.addEventListener("load",y),E.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${l}`)))})}))}function o(a){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=a,window.dispatchEvent(s),!s.defaultPrevented)throw a}return r.then(a=>{for(const s of a||[])s.status==="rejected"&&o(s.reason);return t().catch(o)})};class k extends Error{constructor(t,n){super(t),this.input=n}}k.prototype.name="RuntimeError";function at(e){return e&&typeof e.next=="function"&&typeof e.return=="function"}function fe(e){return()=>e}function te(e){return e}function st(e){return()=>{throw e}}const ut=Array.prototype,dt=ut.map;function j(){}const ge=1,Z=2,Q=3,Y=Symbol("no-observer"),lt=Promise.resolve();function W(e,t,n,i){n||(n=Y),Object.defineProperties(this,{_observer:{value:n,writable:!0},_definition:{value:_e,writable:!0},_duplicate:{value:void 0,writable:!0},_duplicates:{value:void 0,writable:!0},_indegree:{value:NaN,writable:!0},_inputs:{value:[],writable:!0},_invalidate:{value:j,writable:!0},_module:{value:t},_name:{value:null,writable:!0},_outputs:{value:new Set,writable:!0},_promise:{value:lt,writable:!0},_reachable:{value:n!==Y,writable:!0},_rejector:{value:mt(this)},_shadow:{value:ct(t,i)},_type:{value:e},_value:{value:void 0,writable:!0},_version:{value:0,writable:!0}})}Object.defineProperties(W.prototype,{_pending:{value:bt,writable:!0,configurable:!0},_fulfilled:{value:vt,writable:!0,configurable:!0},_rejected:{value:wt,writable:!0,configurable:!0},_resolve:{value:gt,writable:!0,configurable:!0},define:{value:ht,writable:!0,configurable:!0},delete:{value:yt,writable:!0,configurable:!0},import:{value:_t,writable:!0,configurable:!0}});function ct(e,t){return t?.shadow?new Map(Object.entries(t.shadow).map(([n,i])=>[n,new W(Z,e).define([],i)])):null}function ft(e){e._module._runtime._dirty.add(e),e._outputs.add(this)}function pt(e){e._module._runtime._dirty.add(e),e._outputs.delete(this)}function _e(){throw _e}function B(){throw B}function mt(e){return t=>{throw t===B?t:t===_e?new k(`${e._name} is not defined`,e._name):t instanceof Error&&t.message?new k(t.message,e._name):new k(`${e._name} could not be resolved`,e._name)}}function $e(e){return()=>{throw new k(`${e} is defined more than once`)}}function ht(e,t,n){switch(arguments.length){case 1:{n=e,e=t=null;break}case 2:{n=t,typeof e=="string"?t=null:(t=e,e=null);break}}return ye.call(this,e==null?null:String(e),t==null?[]:dt.call(t,this._resolve,this),typeof n=="function"?n:fe(n))}function gt(e){return this._shadow?.get(e)??this._module._resolve(e)}function ye(e,t,n){const i=this._module._scope,r=this._module._runtime;if(this._inputs.forEach(pt,this),t.forEach(ft,this),this._inputs=t,this._definition=n,this._value=void 0,n===j?r._variables.delete(this):r._variables.add(this),e!==this._name||i.get(e)!==this){let o,a;if(this._name)if(this._outputs.size)i.delete(this._name),a=this._module._resolve(this._name),a._outputs=this._outputs,this._outputs=new Set,a._outputs.forEach(function(s){s._inputs[s._inputs.indexOf(this)]=a},this),a._outputs.forEach(r._updates.add,r._updates),r._dirty.add(a).add(this),i.set(this._name,a);else if((a=i.get(this._name))===this)i.delete(this._name);else if(a._type===Q)a._duplicates.delete(this),this._duplicate=void 0,a._duplicates.size===1&&(a=a._duplicates.keys().next().value,o=i.get(this._name),a._outputs=o._outputs,o._outputs=new Set,a._outputs.forEach(function(s){s._inputs[s._inputs.indexOf(o)]=a}),a._definition=a._duplicate,a._duplicate=void 0,r._dirty.add(o).add(a),r._updates.add(a),i.set(this._name,a));else throw new Error;if(this._outputs.size)throw new Error;e&&((a=i.get(e))?a._type===Q?(this._definition=$e(e),this._duplicate=n,a._duplicates.add(this)):a._type===Z?(this._outputs=a._outputs,a._outputs=new Set,this._outputs.forEach(function(s){s._inputs[s._inputs.indexOf(a)]=this},this),r._dirty.add(a).add(this),i.set(e,this)):(a._duplicate=a._definition,this._duplicate=n,o=new W(Q,this._module),o._name=e,o._definition=this._definition=a._definition=$e(e),o._outputs=a._outputs,a._outputs=new Set,o._outputs.forEach(function(s){s._inputs[s._inputs.indexOf(a)]=o}),o._duplicates=new Set([this,a]),r._dirty.add(a).add(o),r._updates.add(a).add(o),i.set(e,o)):i.set(e,this)),this._name=e}return this._version>0&&++this._version,r._updates.add(this),r._compute(),this}function _t(e,t,n){return arguments.length<3&&(n=t,t=e),ye.call(this,String(t),[n._resolve(String(e))],te)}function yt(){return ye.call(this,null,[],j)}function bt(){this._observer.pending&&this._observer.pending()}function vt(e){this._observer.fulfilled&&this._observer.fulfilled(e,this._name)}function wt(e){this._observer.rejected&&this._observer.rejected(e,this._name)}const Me=Symbol("variable"),je=Symbol("invalidation"),We=Symbol("visibility");function ne(e,t=[]){Object.defineProperties(this,{_runtime:{value:e},_scope:{value:new Map},_builtins:{value:new Map([["@variable",Me],["invalidation",je],["visibility",We],...t])},_source:{value:null,writable:!0}})}Object.defineProperties(ne.prototype,{_resolve:{value:Tt,writable:!0,configurable:!0},redefine:{value:xt,writable:!0,configurable:!0},define:{value:Et,writable:!0,configurable:!0},derive:{value:Pt,writable:!0,configurable:!0},import:{value:St,writable:!0,configurable:!0},value:{value:It,writable:!0,configurable:!0},variable:{value:Ct,writable:!0,configurable:!0},builtin:{value:$t,writable:!0,configurable:!0}});function xt(e){const t=this._scope.get(e);if(!t)throw new k(`${e} is not defined`);if(t._type===Q)throw new k(`${e} is defined more than once`);return t.define.apply(t,arguments)}function Et(){const e=new W(ge,this);return e.define.apply(e,arguments)}function St(){const e=new W(ge,this);return e.import.apply(e,arguments)}function Ct(e,t){return new W(ge,this,e,t)}async function It(e){let t=this._scope.get(e);if(!t)throw new k(`${e} is not defined`);if(t._observer===Y){t=this.variable(!0).define([e],te);try{return await pe(this._runtime,t)}finally{t.delete()}}else return pe(this._runtime,t)}async function pe(e,t){await e._compute();try{return await t._promise}catch(n){if(n===B)return pe(e,t);throw n}}function Pt(e,t){const n=new Map,i=new Set,r=[];function o(s){let d=n.get(s);return d||(d=new ne(s._runtime,s._builtins),d._source=s,n.set(s,d),r.push([d,s]),i.add(s),d)}const a=o(this);for(const s of e){const{alias:d,name:u}=typeof s=="object"?s:{name:s};a.import(u,d??u,t)}for(const s of i)for(const[d,u]of s._scope)if(u._definition===te){if(s===this&&a._scope.has(d))continue;const l=u._inputs[0]._module;l._source&&o(l)}for(const[s,d]of r)for(const[u,l]of d._scope){const c=s._scope.get(u);if(!(c&&c._type!==Z))if(l._definition===te){const p=l._inputs[0],h=p._module;s.import(p._name,u,n.get(h)||h)}else s.define(u,l._inputs.map(Ot),l._definition)}return a}function Tt(e){let t=this._scope.get(e),n;if(!t)if(t=new W(Z,this),this._builtins.has(e))t.define(e,fe(this._builtins.get(e)));else if(this._runtime._builtin._scope.has(e))t.import(e,this._runtime._builtin);else{try{n=this._runtime._global(e)}catch(i){return t.define(e,st(i))}n===void 0?this._scope.set(t._name=e,t):t.define(e,fe(n))}return t}function $t(e,t){this._builtins.set(e,t)}function Ot(e){return e._name}const At=typeof requestAnimationFrame=="function"?requestAnimationFrame:typeof setImmediate=="function"?setImmediate:e=>setTimeout(e,0);function Ne(e,t=Jt){const n=this.module();if(Object.defineProperties(this,{_dirty:{value:new Set},_updates:{value:new Set},_precomputes:{value:[],writable:!0},_computing:{value:null,writable:!0},_init:{value:null,writable:!0},_modules:{value:new Map},_variables:{value:new Set},_disposed:{value:!1,writable:!0},_builtin:{value:n},_global:{value:t}}),e)for(const i in e)new W(Z,n).define(i,[],e[i])}Object.defineProperties(Ne.prototype,{_precompute:{value:Rt,writable:!0,configurable:!0},_compute:{value:kt,writable:!0,configurable:!0},_computeSoon:{value:Bt,writable:!0,configurable:!0},_computeNow:{value:Mt,writable:!0,configurable:!0},dispose:{value:Dt,writable:!0,configurable:!0},module:{value:Lt,writable:!0,configurable:!0}});function Dt(){this._computing=Promise.resolve(),this._disposed=!0,this._variables.forEach(e=>{e._invalidate(),e._version=NaN})}function Lt(e,t=j){let n;if(e===void 0)return(n=this._init)?(this._init=null,n):new ne(this);if(n=this._modules.get(e),n)return n;this._init=n=new ne(this),this._modules.set(e,n);try{e(this,t)}finally{this._init=null}return n}function Rt(e){this._precomputes.push(e),this._compute()}function kt(){return this._computing||(this._computing=this._computeSoon())}function Bt(){return new Promise(At).then(()=>this._disposed?void 0:this._computeNow())}async function Mt(){let e=[],t,n,i=this._precomputes;if(i.length){this._precomputes=[];for(const o of i)o();await jt(3)}t=new Set(this._dirty),t.forEach(function(o){o._inputs.forEach(t.add,t);const a=Yt(o);a>o._reachable?this._updates.add(o):a<o._reachable&&o._invalidate(),o._reachable=a},this),t=new Set(this._updates),t.forEach(function(o){o._reachable?(o._indegree=0,o._outputs.forEach(t.add,t)):(o._indegree=NaN,t.delete(o))}),this._computing=null,this._updates.clear(),this._dirty.clear(),t.forEach(function(o){o._outputs.forEach(Nt)});do{for(t.forEach(function(o){o._indegree===0&&e.push(o)});n=e.pop();)Ht(n),n._outputs.forEach(r),t.delete(n);t.forEach(function(o){Wt(o)&&(Ut(o,new k("circular definition")),o._outputs.forEach(qt),t.delete(o))})}while(t.size);function r(o){--o._indegree===0&&e.push(o)}}function jt(e=0){let t=Promise.resolve();for(let n=0;n<e;++n)t=t.then(()=>{});return t}function Wt(e){const t=new Set(e._inputs);for(const n of t){if(n===e)return!0;n._inputs.forEach(t.add,t)}return!1}function Nt(e){++e._indegree}function qt(e){--e._indegree}function Vt(e){return e._promise.catch(e._rejector)}function le(e){return new Promise(function(t){e._invalidate=t})}function Ft(e,t){let n=typeof IntersectionObserver=="function"&&t._observer&&t._observer._node,i=!n,r=j,o=j,a,s;return n&&(s=new IntersectionObserver(([d])=>(i=d.isIntersecting)&&(a=null,r())),s.observe(n),e.then(()=>(s.disconnect(),s=null,o()))),function(d){return i?Promise.resolve(d):s?(a||(a=new Promise((u,l)=>(r=u,o=l))),a.then(()=>d)):Promise.reject()}}function Ht(e){e._invalidate(),e._invalidate=j,e._pending();const t=e._value,n=++e._version,i=e._inputs,r=e._definition;let o=null;const a=e._promise=e._promise.then(s,s).then(d).then(u);function s(){return Promise.all(i.map(Vt))}function d(l){if(e._version!==n)throw B;for(let c=0,p=l.length;c<p;++c)switch(l[c]){case je:{l[c]=o=le(e);break}case We:{o||(o=le(e)),l[c]=Ft(o,e);break}case Me:{l[c]=e;break}}return r.apply(t,l)}function u(l){if(e._version!==n)throw B;return at(l)?((o||le(e)).then(Gt(l)),zt(e,n,l)):l}a.then(l=>{e._value=l,e._fulfilled(l)},l=>{l===B||e._version!==n||(e._value=void 0,e._rejected(l))})}function zt(e,t,n){const i=e._module._runtime;let r;function o(d){return new Promise(u=>u(n.next(r))).then(({done:u,value:l})=>u?void 0:Promise.resolve(l).then(d))}function a(){const d=o(u=>{if(e._version!==t)throw B;return r=u,s(u,d).then(()=>i._precompute(a)),e._fulfilled(u),u});d.catch(u=>{u===B||e._version!==t||(s(void 0,d),e._rejected(u))})}function s(d,u){return e._value=d,e._promise=u,e._outputs.forEach(i._updates.add,i._updates),i._compute()}return o(d=>{if(e._version!==t)throw B;return r=d,i._precompute(a),d})}function Ut(e,t){e._invalidate(),e._invalidate=j,e._pending(),++e._version,e._indegree=NaN,(e._promise=Promise.reject(t)).catch(j),e._value=void 0,e._rejected(t)}function Gt(e){return function(){e.return()}}function Yt(e){if(e._observer!==Y)return!0;const t=new Set(e._outputs);for(const n of t){if(n._observer!==Y)return!0;n._outputs.forEach(t.add,t)}return!1}function Jt(e){return globalThis[e]}function ie(e,t,n){n=n||{};var i=e.ownerDocument,r=i.defaultView.CustomEvent;typeof r=="function"?r=new r(t,{detail:n}):(r=i.createEvent("Event"),r.initEvent(t,!1,!1),r.detail=n),e.dispatchEvent(r)}function qe(e){return Array.isArray(e)||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array}function Ve(e){return e===(e|0)+""}function L(e){const t=document.createElement("span");return t.className="observablehq--cellname",t.textContent=`${e} = `,t}const Zt=Symbol.prototype.toString;function H(e){return Zt.call(e)}const{getOwnPropertySymbols:Kt,prototype:{hasOwnProperty:Xt}}=Object,{toStringTag:Qt}=Symbol,Fe={},K=Kt;function ue(e,t){return Xt.call(e,t)}function me(e){return e[Qt]||e.constructor&&e.constructor.name||"Object"}function O(e,t){try{const n=e[t];return n&&n.constructor,n}catch{return Fe}}const en=[{symbol:"@@__IMMUTABLE_INDEXED__@@",name:"Indexed",modifier:!0},{symbol:"@@__IMMUTABLE_KEYED__@@",name:"Keyed",modifier:!0},{symbol:"@@__IMMUTABLE_LIST__@@",name:"List",arrayish:!0},{symbol:"@@__IMMUTABLE_MAP__@@",name:"Map"},{symbol:"@@__IMMUTABLE_ORDERED__@@",name:"Ordered",modifier:!0,prefix:!0},{symbol:"@@__IMMUTABLE_RECORD__@@",name:"Record"},{symbol:"@@__IMMUTABLE_SET__@@",name:"Set",arrayish:!0,setish:!0},{symbol:"@@__IMMUTABLE_STACK__@@",name:"Stack",arrayish:!0}];function He(e){try{let t=en.filter(({symbol:a})=>e[a]===!0);if(!t.length)return;const n=t.find(a=>!a.modifier),i=n.name==="Map"&&t.find(a=>a.modifier&&a.prefix),r=t.some(a=>a.arrayish),o=t.some(a=>a.setish);return{name:`${i?i.name:""}${n.name}`,symbols:t,arrayish:r&&!o,setish:o}}catch{return null}}const{getPrototypeOf:be,getOwnPropertyDescriptors:tn}=Object,ze=be({});function Ue(e,t,n,i){let r=qe(e),o,a,s,d;e instanceof Map?e instanceof e.constructor?(o=`Map(${e.size})`,a=nn):(o="Map()",a=U):e instanceof Set?e instanceof e.constructor?(o=`Set(${e.size})`,a=rn):(o="Set()",a=U):r?(o=`${e.constructor.name}(${e.length})`,a=an):(d=He(e))?(o=`Immutable.${d.name}${d.name==="Record"?"":`(${e.size})`}`,r=d.arrayish,a=d.arrayish?sn:d.setish?on:dn):i?(o=me(e),a=un):(o=me(e),a=U);const u=document.createElement("span");u.className="observablehq--expanded",n&&u.appendChild(L(n));const l=u.appendChild(document.createElement("a"));l.innerHTML=`<svg width=8 height=8 class='observablehq--caret'>
    <path d='M4 7L0 1h8z' fill='currentColor' />
  </svg>`,l.appendChild(document.createTextNode(`${o}${r?" [":" {"}`)),l.addEventListener("mouseup",function(c){c.stopPropagation(),oe(u,ve(e,null,n,i))}),a=a(e);for(let c=0;!(s=a.next()).done&&c<20;++c)u.appendChild(s.value);if(!s.done){const c=u.appendChild(document.createElement("a"));c.className="observablehq--field",c.style.display="block",c.appendChild(document.createTextNode("  … more")),c.addEventListener("mouseup",function(p){p.stopPropagation(),u.insertBefore(s.value,u.lastChild.previousSibling);for(let h=0;!(s=a.next()).done&&h<19;++h)u.insertBefore(s.value,u.lastChild.previousSibling);s.done&&u.removeChild(u.lastChild.previousSibling),ie(u,"load")})}return u.appendChild(document.createTextNode(r?"]":"}")),u}function*nn(e){for(const[t,n]of e)yield ln(t,n);yield*U(e)}function*rn(e){for(const t of e)yield Ye(t);yield*U(e)}function*on(e){for(const t of e)yield Ye(t)}function*an(e){for(let t=0,n=e.length;t<n;++t)t in e&&(yield M(t,O(e,t),"observablehq--index"));for(const t in e)!Ve(t)&&ue(e,t)&&(yield M(t,O(e,t),"observablehq--key"));for(const t of K(e))yield M(H(t),O(e,t),"observablehq--symbol")}function*sn(e){let t=0;for(const n=e.size;t<n;++t)yield M(t,e.get(t),!0)}function*un(e){for(const n in tn(e))yield M(n,O(e,n),"observablehq--key");for(const n of K(e))yield M(H(n),O(e,n),"observablehq--symbol");const t=be(e);t&&t!==ze&&(yield Ge(t))}function*U(e){for(const n in e)ue(e,n)&&(yield M(n,O(e,n),"observablehq--key"));for(const n of K(e))yield M(H(n),O(e,n),"observablehq--symbol");const t=be(e);t&&t!==ze&&(yield Ge(t))}function*dn(e){for(const[t,n]of e)yield M(t,n,"observablehq--key")}function Ge(e){const t=document.createElement("div"),n=t.appendChild(document.createElement("span"));return t.className="observablehq--field",n.className="observablehq--prototype-key",n.textContent="  <prototype>",t.appendChild(document.createTextNode(": ")),t.appendChild(T(e,void 0,void 0,void 0,!0)),t}function M(e,t,n){const i=document.createElement("div"),r=i.appendChild(document.createElement("span"));return i.className="observablehq--field",r.className=n,r.textContent=`  ${e}`,i.appendChild(document.createTextNode(": ")),i.appendChild(T(t)),i}function ln(e,t){const n=document.createElement("div");return n.className="observablehq--field",n.appendChild(document.createTextNode("  ")),n.appendChild(T(e)),n.appendChild(document.createTextNode(" => ")),n.appendChild(T(t)),n}function Ye(e){const t=document.createElement("div");return t.className="observablehq--field",t.appendChild(document.createTextNode("  ")),t.appendChild(T(e)),t}function Oe(e){const t=window.getSelection();return t.type==="Range"&&(t.containsNode(e,!0)||e.contains(t.anchorNode)||e.contains(t.focusNode))}function ve(e,t,n,i){let r=qe(e),o,a,s,d;if(e instanceof Map?e instanceof e.constructor?(o=`Map(${e.size})`,a=cn):(o="Map()",a=G):e instanceof Set?e instanceof e.constructor?(o=`Set(${e.size})`,a=fn):(o="Set()",a=G):r?(o=`${e.constructor.name}(${e.length})`,a=hn):(d=He(e))?(o=`Immutable.${d.name}${d.name==="Record"?"":`(${e.size})`}`,r=d.arrayish,a=d.arrayish?mn:d.setish?pn:gn):(o=me(e),a=G),t){const c=document.createElement("span");return c.className="observablehq--shallow",n&&c.appendChild(L(n)),c.appendChild(document.createTextNode(o)),c.addEventListener("mouseup",function(p){Oe(c)||(p.stopPropagation(),oe(c,ve(e)))}),c}const u=document.createElement("span");u.className="observablehq--collapsed",n&&u.appendChild(L(n));const l=u.appendChild(document.createElement("a"));l.innerHTML=`<svg width=8 height=8 class='observablehq--caret'>
    <path d='M7 4L1 8V0z' fill='currentColor' />
  </svg>`,l.appendChild(document.createTextNode(`${o}${r?" [":" {"}`)),u.addEventListener("mouseup",function(c){Oe(u)||(c.stopPropagation(),oe(u,Ue(e,null,n,i)))},!0),a=a(e);for(let c=0;!(s=a.next()).done&&c<20;++c)c>0&&u.appendChild(document.createTextNode(", ")),u.appendChild(s.value);return s.done||u.appendChild(document.createTextNode(", …")),u.appendChild(document.createTextNode(r?"]":"}")),u}function*cn(e){for(const[t,n]of e)yield _n(t,n);yield*G(e)}function*fn(e){for(const t of e)yield T(t,!0);yield*G(e)}function*pn(e){for(const t of e)yield T(t,!0)}function*mn(e){let t=-1,n=0;for(const i=e.size;n<i;++n)n>t+1&&(yield re(n-t-1)),yield T(e.get(n),!0),t=n;n>t+1&&(yield re(n-t-1))}function*hn(e){let t=-1,n=0;for(const i=e.length;n<i;++n)n in e&&(n>t+1&&(yield re(n-t-1)),yield T(O(e,n),!0),t=n);n>t+1&&(yield re(n-t-1));for(const i in e)!Ve(i)&&ue(e,i)&&(yield J(i,O(e,i),"observablehq--key"));for(const i of K(e))yield J(H(i),O(e,i),"observablehq--symbol")}function*G(e){for(const t in e)ue(e,t)&&(yield J(t,O(e,t),"observablehq--key"));for(const t of K(e))yield J(H(t),O(e,t),"observablehq--symbol")}function*gn(e){for(const[t,n]of e)yield J(t,n,"observablehq--key")}function re(e){const t=document.createElement("span");return t.className="observablehq--empty",t.textContent=e===1?"empty":`empty × ${e}`,t}function J(e,t,n){const i=document.createDocumentFragment(),r=i.appendChild(document.createElement("span"));return r.className=n,r.textContent=e,i.appendChild(document.createTextNode(": ")),i.appendChild(T(t,!0)),i}function _n(e,t){const n=document.createDocumentFragment();return n.appendChild(T(e,!0)),n.appendChild(document.createTextNode(" => ")),n.appendChild(T(t,!0)),n}function yn(e,t){if(e instanceof Date||(e=new Date(+e)),isNaN(e))return typeof t=="function"?t(e):t;const n=e.getUTCHours(),i=e.getUTCMinutes(),r=e.getUTCSeconds(),o=e.getUTCMilliseconds();return`${bn(e.getUTCFullYear())}-${R(e.getUTCMonth()+1,2)}-${R(e.getUTCDate(),2)}${n||i||r||o?`T${R(n,2)}:${R(i,2)}${r||o?`:${R(r,2)}${o?`.${R(o,3)}`:""}`:""}Z`:""}`}function bn(e){return e<0?`-${R(-e,6)}`:e>9999?`+${R(e,6)}`:R(e,4)}function R(e,t){return`${e}`.padStart(t,"0")}function vn(e){return yn(e,"Invalid Date")}var wn=Error.prototype.toString;function xn(e){return e.stack||wn.call(e)}var En=RegExp.prototype.toString;function Sn(e){return En.call(e)}const ce=20;function Cn(e,t,n,i){if(t===!1){if(De(e,/["\n]/g)<=De(e,/`|\${/g)){const u=document.createElement("span");i&&u.appendChild(L(i));const l=u.appendChild(document.createElement("span"));return l.className="observablehq--string",l.textContent=JSON.stringify(e),u}const a=e.split(`
`);if(a.length>ce&&!n){const u=document.createElement("div");i&&u.appendChild(L(i));const l=u.appendChild(document.createElement("span"));l.className="observablehq--string",l.textContent="`"+Ae(a.slice(0,ce).join(`
`));const c=u.appendChild(document.createElement("span")),p=a.length-ce;return c.textContent=`Show ${p} truncated line${p>1?"s":""}`,c.className="observablehq--string-expand",c.addEventListener("mouseup",function(h){h.stopPropagation(),oe(u,T(e,t,!0,i))}),u}const s=document.createElement("span");i&&s.appendChild(L(i));const d=s.appendChild(document.createElement("span"));return d.className=`observablehq--string${n?" observablehq--expanded":""}`,d.textContent="`"+Ae(e)+"`",s}const r=document.createElement("span");i&&r.appendChild(L(i));const o=r.appendChild(document.createElement("span"));return o.className="observablehq--string",o.textContent=JSON.stringify(e.length>100?`${e.slice(0,50)}…${e.slice(-49)}`:e),r}function Ae(e){return e.replace(/[\\`\x00-\x09\x0b-\x19]|\${/g,In)}function In(e){var t=e.charCodeAt(0);switch(t){case 8:return"\\b";case 9:return"\\t";case 11:return"\\v";case 12:return"\\f";case 13:return"\\r"}return t<16?"\\x0"+t.toString(16):t<32?"\\x"+t.toString(16):"\\"+e}function De(e,t){for(var n=0;t.exec(e);)++n;return n}var Pn=Function.prototype.toString,Tn={prefix:"async ƒ"},$n={prefix:"async ƒ*"},Le={prefix:"class"},On={prefix:"ƒ"},An={prefix:"ƒ*"};function Dn(e,t){var n,i,r=Pn.call(e);switch(e.constructor&&e.constructor.name){case"AsyncFunction":n=Tn;break;case"AsyncGeneratorFunction":n=$n;break;case"GeneratorFunction":n=An;break;default:n=/^class\b/.test(r)?Le:On;break}return n===Le?z(n,"",t):(i=/^(?:async\s*)?(\w+)\s*=>/.exec(r))?z(n,"("+i[1]+")",t):(i=/^(?:async\s*)?\(\s*(\w+(?:\s*,\s*\w+)*)?\s*\)/.exec(r))?z(n,i[1]?"("+i[1].replace(/\s*,\s*/g,", ")+")":"()",t):(i=/^(?:async\s*)?function(?:\s*\*)?(?:\s*\w+)?\s*\(\s*(\w+(?:\s*,\s*\w+)*)?\s*\)/.exec(r))?z(n,i[1]?"("+i[1].replace(/\s*,\s*/g,", ")+")":"()",t):z(n,"(…)",t)}function z(e,t,n){var i=document.createElement("span");i.className="observablehq--function",n&&i.appendChild(L(n));var r=i.appendChild(document.createElement("span"));return r.className="observablehq--keyword",r.textContent=e.prefix,i.appendChild(document.createTextNode(t)),i}const{prototype:{toString:Ln}}=Object;function T(e,t,n,i,r){let o=typeof e;switch(o){case"boolean":case"undefined":{e+="";break}case"number":{e=e===0&&1/e<0?"-0":e+"";break}case"bigint":{e=e+"n";break}case"symbol":{e=H(e);break}case"function":return Dn(e,i);case"string":return Cn(e,t,n,i);default:{if(e===null){o=null,e="null";break}if(e instanceof Date){o="date",e=vn(e);break}if(e===Fe){o="forbidden",e="[forbidden]";break}switch(Ln.call(e)){case"[object RegExp]":{o="regexp",e=Sn(e);break}case"[object Error]":case"[object DOMException]":{o="error",e=xn(e);break}default:return(n?Ue:ve)(e,t,i,r)}break}}const a=document.createElement("span");i&&a.appendChild(L(i));const s=a.appendChild(document.createElement("span"));return s.className=`observablehq--${o}`,s.textContent=e,a}function oe(e,t){e.classList.contains("observablehq--inspect")&&t.classList.add("observablehq--inspect"),e.parentNode.replaceChild(t,e),ie(t,"load")}const Rn=/\s+\(\d+:\d+\)$/m;class ae{constructor(t){if(!t)throw new Error("invalid node");this._node=t,t.classList.add("observablehq")}pending(){const{_node:t}=this;t.classList.remove("observablehq--error"),t.classList.add("observablehq--running")}fulfilled(t,n){const{_node:i}=this;if((!kn(t)||t.parentNode&&t.parentNode!==i)&&(t=T(t,!1,i.firstChild&&i.firstChild.classList&&i.firstChild.classList.contains("observablehq--expanded"),n),t.classList.add("observablehq--inspect")),i.classList.remove("observablehq--running","observablehq--error"),i.firstChild!==t)if(i.firstChild){for(;i.lastChild!==i.firstChild;)i.removeChild(i.lastChild);i.replaceChild(t,i.firstChild)}else i.appendChild(t);ie(i,"update")}rejected(t,n){const{_node:i}=this;for(i.classList.remove("observablehq--running"),i.classList.add("observablehq--error");i.lastChild;)i.removeChild(i.lastChild);var r=document.createElement("div");r.className="observablehq--inspect",n&&r.appendChild(L(n)),r.appendChild(document.createTextNode((t+"").replace(Rn,""))),i.appendChild(r),ie(i,"error",{error:t})}}ae.into=function(e){if(typeof e=="string"&&(e=document.querySelector(e),e==null))throw new Error("container not found");return function(){return new ae(e.appendChild(document.createElement("div")))}};function kn(e){return(e instanceof Element||e instanceof Text)&&e instanceof e.constructor}function Bn(e,t){const n=document.createElement("div");if(new ae(n).fulfilled(e),t)for(const i of t){let r=n;for(const o of i)r=r?.childNodes[o];r?.dispatchEvent(new Event("mouseup"))}return n}function Mn(e){const t=document.createElement("div");return new ae(t).rejected(e),t}function jn(e){if(!Nn(e))return;const t=e.querySelectorAll(".observablehq--expanded");if(t.length)return Array.from(t,n=>qn(e,n))}function Wn(e){return e.nodeType===1}function Nn(e){return Wn(e)&&e.classList.contains("observablehq")}function qn(e,t){const n=[];for(;t!==e;)n.push(Vn(t)),t=t.parentNode;return n.reverse()}function Vn(e){return Array.prototype.indexOf.call(e.parentNode.childNodes,e)}const Fn=["audio source[src]","audio[src]","img[src]","picture source[src]","video source[src]","video[src]"].join(),Hn=["img[srcset]","picture source[srcset]"].join(),zn=["a[href][download]","link[href]"].join(),Un=[[Fn,"src"],[Hn,"srcset"],[zn,"href"]];function Gn(e,t){const n=i=>t.get(Zn(i))??i;for(const[i,r]of Un)for(const o of e.querySelectorAll(i)){if(Yn(o))continue;const a=decodeURI(o.getAttribute(r));r==="srcset"?o.setAttribute(r,Xn(a,n)):o.setAttribute(r,n(a))}}function Yn(e){return/(?:^|\s)external(?:\s|$)/i.test(e.getAttribute("rel")??"")}function Jn(e){const t=e.indexOf("?"),n=e.indexOf("#"),i=t>=0&&n>=0?Math.min(t,n):t>=0?t:n;return i>=0?e.slice(0,i):e}function Zn(e){const t=Jn(e);return Kn(t)?t:`./${t}`}function Kn(e){return["./","../","/"].some(t=>e.startsWith(t))}function Xn(e,t){return e.trim().split(/\s*,\s*/).filter(n=>n).map(n=>{const i=n.split(/\s+/),r=t(i[0]);return r&&(i[0]=encodeURI(r)),i.join(" ")}).join(", ")}function Je(e,t){const{root:n,expanded:i}=e,r=ei(t,n)?t:Bn(t,i[n.childNodes.length]);Ze(e,r)}function Ze(e,t){if(t.nodeType===11){let n;for(;n=t.firstChild;)e.root.appendChild(n)}else e.root.appendChild(t)}function Qn(e,t){Ze(e,Mn(t))}function ei(e,t){return(e instanceof Element||e instanceof Text)&&e instanceof e.constructor&&(!e.parentNode||t.contains(e))}function V(e){for(e.autoclear=!1,e.expanded=Array.from(e.root.childNodes,jn);e.root.lastChild;)e.root.lastChild.remove()}function ti(e,{autodisplay:t,assets:n}){return{_error:!1,_node:e.root,pending(){this._error&&(this._error=!1,V(e))},fulfilled(i){t?(n&&i instanceof Element&&Gn(i,n),V(e),Je(e,i)):e.autoclear&&V(e)},rejected(i){console.error(i),this._error=!0,V(e),Qn(e,i)}}}function de(e){let t,n,i,r=!1;const o=e(a=>(i=a,t!=null?(t(a),t=n=void 0):r=!0,a));if(o!=null&&typeof o!="function")throw new Error(typeof o=="object"&&typeof o.then=="function"?"async initializers are not supported":"initializer returned something, but not a dispose function");return{async next(){return{done:!1,value:await(r?(r=!1,i):new Promise((a,s)=>(t=a,n=s)))}},async return(){return n!=null&&(n(new Error("Generator returned")),t=n=void 0),o?.(),{done:!0,value:void 0}},async throw(a){return n!=null&&(n(a),t=n=void 0),o?.(),{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}function he(e){return de(t=>{const n=ni(e),i=Re(e),r=()=>t(Re(e));return e.addEventListener(n,r),i!==void 0&&t(i),()=>e.removeEventListener(n,r)})}function Re(e){const t=e,n=e;if("type"in e)switch(e.type){case"range":case"number":return t.valueAsNumber;case"date":return t.valueAsDate;case"checkbox":return t.checked;case"file":return t.multiple?t.files:t.files[0];case"select-multiple":return Array.from(n.selectedOptions,i=>i.value)}return t.value}function ni(e){if("type"in e)switch(e.type){case"button":case"submit":case"checkbox":return"click";case"file":return"change"}return"input"}async function*Ke(){for(;;)yield Date.now()}function ii(e){let t,n;const i=[],r=e(o=>(i.push(o),t!=null&&(t(i.shift()),t=void 0),o));if(r!=null&&typeof r!="function")throw new Error(typeof r=="object"&&typeof r.then=="function"?"async initializers are not supported":"initializer returned something, but not a dispose function");return{async next(){return{done:!1,value:await(i.length?i.shift():new Promise((o,a)=>(t=o,n=a)))}},async return(){return n!=null&&(n(new Error("Generator returned")),t=n=void 0),r?.(),{done:!0,value:void 0}},async throw(o){return n!=null&&(n(o),t=n=void 0),r?.(),{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}function Xe(e,t){return de(n=>{let i;const r=new ResizeObserver(([o])=>{const a=o.contentRect.width;a!==i&&n(i=a)});return r.observe(e,t),()=>r.disconnect()})}const ri=Object.freeze(Object.defineProperty({__proto__:null,input:he,now:Ke,observe:de,queue:ii,width:Xe},Symbol.toStringTag,{value:"Module"}));function Qe(e){let t;return Object.defineProperty(de(n=>{t=n,e!==void 0&&t(e)}),"value",{get:()=>e,set:n=>(e=n,void t?.(e))})}function oi(e){const t=Qe(e);return[t,{get value(){return t.value},set value(n){t.value=n}}]}function ai(e,t,n,i=ti){const{id:r,body:o,inputs:a=[],outputs:s=[],output:d,autodisplay:u,autoview:l,automutable:c}=n,p=t.variables,h=e.variable(i(t,n),{shadow:{}}),E=d??(s.length?`cell ${r}`:null);if(t.autoclear=!0,a.includes("display")||a.includes("view")){let y=-1;const b=new h.constructor(2,h._module);if(b.define(a.filter(v=>v!=="display"&&v!=="view"),()=>{const v=h._version;return x=>{if(v<y)throw new Error("stale display");if(t.variables[0]!==h)throw new Error("stale display");return v>y&&V(t),y=v,Je(t,x),x}}),h._shadow.set("display",b),a.includes("view")){const v=new h.constructor(2,h._module,null,{shadow:{}});v._shadow.set("display",b),v.define(["display"],x=>g=>he(x(g))),h._shadow.set("view",v)}}else u||V(t);if(p.push(h.define(E,a,o)),d!=null){if(l){const y=ke(d,"viewof$");p.push(e.define(y,[d],he))}else if(c){const y=ke(d,"mutable "),b=`cell ${r}`;h.define(y,[b],([v])=>v),p.push(e.define(d,a,o),e.define(b,[d],oi),e.define(`mutable$${y}`,[b],([,v])=>v))}}else for(const y of s)p.push(e.variable(!0).define(y,[E],b=>b[y]))}function ke(e,t){if(!e.startsWith(t))throw new Error(`expected ${t}: ${e}`);return e.slice(t.length)}const Be=new Map,we=(e,t=document.baseURI)=>{const n=new URL(e,t).href;let i=Be.get(n);return i||(i=new F(n,e.split("/").pop()),Be.set(n,i)),i};async function q(e){const t=await fetch(e.href);if(!t.ok)throw new Error(`Unable to load file: ${e.name}`);return t}class si{constructor(t,n=ui(t),i,r){Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mimeType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lastModified",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperties(this,{name:{value:`${t}`,enumerable:!0},mimeType:{value:`${n}`,enumerable:!0},lastModified:{value:i===void 0?void 0:+i,enumerable:!0},size:{value:r===void 0?void 0:+r,enumerable:!0}})}async url(){return this.href}async blob(){return(await q(this)).blob()}async arrayBuffer(){return(await q(this)).arrayBuffer()}async text(t){return t===void 0?(await q(this)).text():new TextDecoder(t).decode(await this.arrayBuffer())}async json(){return(await q(this)).json()}async stream(){return(await q(this)).body}async dsv({delimiter:t=",",array:n=!1,typed:i=!1}={}){const[r,o]=await Promise.all([this.text(),f(()=>import("https://cdn.jsdelivr.net/npm/d3-dsv/+esm"),[],import.meta.url)]),a=o.dsvFormat(t);return(n?a.parseRows:a.parse)(r,i&&o.autoType)}async csv(t){return this.dsv({...t,delimiter:","})}async tsv(t){return this.dsv({...t,delimiter:"	"})}async image(t){const n=await this.url();return new Promise((i,r)=>{const o=new Image;new URL(n,document.baseURI).origin!==location.origin&&(o.crossOrigin="anonymous"),Object.assign(o,t),o.onload=()=>i(o),o.onerror=()=>r(new Error(`Unable to load file: ${this.name}`)),o.src=n})}async arrow(){const[t,n]=await Promise.all([f(()=>import("https://cdn.jsdelivr.net/npm/apache-arrow@17.0.0/+esm"),[],import.meta.url),q(this)]);return t.tableFromIPC(n)}async arquero(t){let n,i;switch(this.mimeType){case"application/json":n=this.text(),i="fromJSON";break;case"text/tab-separated-values":t?.delimiter===void 0&&(t={...t,delimiter:"	"});case"text/csv":n=this.text(),i="fromCSV";break;default:if(/\.arrow$/i.test(this.name))n=this.arrow(),i="fromArrow";else if(/\.parquet$/i.test(this.name))n=this.parquet(),i="fromArrow";else throw new Error(`unable to determine Arquero loader: ${this.name}`);break}const[r,o]=await Promise.all([f(()=>import("https://cdn.jsdelivr.net/npm/arquero/+esm"),[],import.meta.url),n]);return r[i](o,t)}async parquet(){const[t,n,i]=await Promise.all([f(()=>import("https://cdn.jsdelivr.net/npm/apache-arrow@17.0.0/+esm"),[],import.meta.url),f(()=>import("https://cdn.jsdelivr.net/npm/parquet-wasm/+esm"),[],import.meta.url).then(async r=>(await r.default("https://cdn.jsdelivr.net/npm/parquet-wasm/esm/parquet_wasm_bg.wasm"),r)),this.arrayBuffer()]);return t.tableFromIPC(n.readParquet(new Uint8Array(i)).intoIPCStream())}async xml(t="application/xml"){return new DOMParser().parseFromString(await this.text(),t)}async html(){return this.xml("text/html")}}function ui(e){const t=e.lastIndexOf("."),n=e.lastIndexOf("/");switch(t>0&&(n<0||t>n)?e.slice(t).toLowerCase():""){case".csv":return"text/csv";case".tsv":return"text/tab-separated-values";case".json":return"application/json";case".html":return"text/html";case".xml":return"application/xml";case".png":return"image/png";case".jpg":return"image/jpg";case".js":return"text/javascript";default:return"application/octet-stream"}}class F extends si{constructor(t,n,i,r,o){super(n,i,r,o),Object.defineProperty(this,"href",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"href",{value:t})}}Object.defineProperty(F,"name",{value:"FileAttachment"});we.prototype=F.prototype;function di(e){function t(n){const i=e(n+="");if(i==null)throw new Error(`File not found: ${n}`);if(typeof i=="object"&&"url"in i){const{url:r,mimeType:o}=i;return new F(r,n,o)}return new F(i,n)}return t.prototype=F.prototype,t}function li(e,{length:t=50,fallback:n="untitled",separator:i="-"}={}){const r=e.normalize("NFD").replace(/[\u0300-\u036f'‘’]/g,"").toLowerCase().split(/\W+/g).filter(ci);let o=-1;for(let a=0,s=r.length;++o<s;)if((a+=r[o].length)+o>t){r[o]=r[o].substring(0,t-a+r[o].length-o);break}return r.slice(0,o+1).filter(Boolean).join(i)||n.slice(0,t)}function ci(e){return e.length>0}async function xe(e){const t=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",t);return new Uint8Array(n).reduce((i,r)=>i<<8n|BigInt(r),0n)}function Ee(e,t){return e.toString(36).padStart(t,"0").slice(0,t)}async function fi(e,...t){return Ee(await xe(JSON.stringify([e,...t])),16)}async function pi(e){return Ee(await xe(e),16)}async function et(e){return/^[\w-]+$/.test(e)?e:`${li(mi(e))}.${Ee(await xe(e),8)}`}function mi(e){return e.replace(/^.*\//,"")}const Se=(e,t)=>new Ce(e,hi(t));function hi({id:e,since:t}={}){const n={};return e!==void 0&&(n.id=e),t!==void 0&&(n.since=new Date(t)),n}class Ce{constructor(t,n){Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperties(this,{name:{value:t,enumerable:!0},options:{value:n,enumerable:!0}})}async sql(t,...n){const i=await this.cachePath(t,...n),r=await fetch(i);if(!r.ok)throw new Error(`failed to fetch: ${i}`);return await r.json().then(tt)}async cachePath(t,...n){return`.observable/cache/${await et(this.name)}-${await fi(t,...n)}.json`}}function tt({rows:e,schema:t,date:n,...i}){for(const r of t)switch(r.type){case"bigint":{const{name:o}=r;for(const a of e){const s=a[o];s!=null&&(a[o]=Number(s))}break}case"date":{const{name:o}=r;for(const a of e){const s=a[o];s!=null&&(a[o]=gi(s))}break}}return n!=null&&(n=new Date(n)),Object.assign(e,{schema:t,date:n},i)}function gi(e){return new Date(/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}(?::\d{2})?$/.test(e)?e+"Z":e)}Se.revive=tt;Se.prototype=Ce.prototype;Object.defineProperty(Ce,"name",{value:"DatabaseClient"});function _i(e,t){const n=document.createElement("canvas");return n.width=e,n.height=t,n}function yi(e,t,n=devicePixelRatio){const i=document.createElement("canvas");i.width=e*n,i.height=t*n,i.style.width=`${e}px`;const r=i.getContext("2d");return r.scale(n,n),r}function bi(e,t){const n=document.createElementNS("http://www.w3.org/2000/svg","svg");return n.setAttribute("viewBox",`0 0 ${e} ${t}`),n.setAttribute("width",`${e}`),n.setAttribute("height",`${t}`),n}function vi(e){return document.createTextNode(e)}let wi=0;function xi(e){return new Ei(`O-${e==null?"":`${e}-`}${++wi}`)}class Ei{constructor(t){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"href",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.id=t,this.href=new URL(`#${t}`,location.href).href}toString(){return`url(${this.href})`}}const Si=Object.freeze(Object.defineProperty({__proto__:null,canvas:_i,context2d:yi,svg:bi,text:vi,uid:xi},Symbol.toStringTag,{value:"Module"}));function Ci(e){switch(e){case"html":case"text":return".txt";case"jpeg":return".jpg";case"json":case"arrow":case"parquet":case"csv":case"tsv":case"png":case"gif":case"svg":case"webp":case"xml":return`.${e}`;default:return".bin"}}const nt=(e,t)=>new Ie(e,Ii(t));function Ii({format:e="buffer",id:t,since:n}={}){const i={format:e};return t!==void 0&&(i.id=t),n!==void 0&&(i.since=new Date(n)),i}class Ie{constructor(t,n){Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperties(this,{name:{value:t,enumerable:!0},options:{value:n,enumerable:!0}})}async run(t){return we(await this.cachePath(t))}async cachePath(t){const{format:n}=this.options;return`.observable/cache/${await et(this.name)}-${await pi(t)}${Ci(n)}`}}nt.prototype=Ie.prototype;Object.defineProperty(Ie,"name",{value:"Interpreter"});var Pi=function(e,t,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(e):i?i.value:t.get(e)},Ti=function(e,t,n,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(e,n):r?r.value=n:t.set(e,n),n},ee;class $i{constructor(){ee.set(this,void 0),Object.defineProperty(this,"fulfilled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"rejected",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.next()}async next(){const t=await Pi(this,ee,"f");return Ti(this,ee,new Promise((n,i)=>(this.fulfilled=n,this.rejected=i)),"f"),{done:!1,value:t}}throw(){return{done:!0}}return(){return{done:!0}}}ee=new WeakMap;const Oi=()=>f(()=>import("https://cdn.jsdelivr.net/npm/lodash/+esm"),[],import.meta.url).then(e=>e.default),Ai=()=>f(()=>import("https://cdn.jsdelivr.net/npm/arquero/+esm"),[],import.meta.url),Di=()=>f(()=>import("https://cdn.jsdelivr.net/npm/apache-arrow@17.0.0/+esm"),[],import.meta.url),Li=()=>f(()=>import("https://cdn.jsdelivr.net/npm/d3/+esm"),[],import.meta.url),Ri=()=>f(()=>import("./dot-DSyh6hFx.js"),[],import.meta.url).then(e=>e.dot),ki=()=>f(()=>import("https://cdn.jsdelivr.net/npm/@duckdb/duckdb-wasm@1.29.0/+esm"),[],import.meta.url),Bi=()=>f(()=>import("./duckdb-BF4XY6Ds.js"),[],import.meta.url).then(e=>e.DuckDBClient),Mi=()=>f(()=>import("https://cdn.jsdelivr.net/npm/echarts/+esm"),[],import.meta.url),ji=()=>f(()=>import("https://cdn.jsdelivr.net/npm/htl/+esm"),[],import.meta.url),Wi=()=>f(()=>import("https://cdn.jsdelivr.net/npm/htl/+esm"),[],import.meta.url).then(e=>e.html),Ni=()=>f(()=>import("https://cdn.jsdelivr.net/npm/htl/+esm"),[],import.meta.url).then(e=>e.svg),qi=()=>f(()=>import("./inputs-DoHVubAa.js"),__vite__mapDeps([0,1]),import.meta.url),Vi=()=>f(()=>import("./leaflet-D54mqpIu.js"),[],import.meta.url),Fi=()=>f(()=>import("./mapboxgl-C94UFoDx.js"),[],import.meta.url).then(e=>e.default),Hi=()=>f(()=>import("./md-Vsk6kEt_.js"),[],import.meta.url).then(e=>e.md),zi=()=>f(()=>import("./mermaid-CWCaPgOr.js"),[],import.meta.url).then(e=>e.mermaid),Ui=()=>f(()=>import("https://cdn.jsdelivr.net/npm/@observablehq/plot/+esm"),[],import.meta.url),Gi=()=>f(()=>import("https://cdn.jsdelivr.net/npm/react/+esm"),[],import.meta.url),Yi=()=>f(()=>import("https://cdn.jsdelivr.net/npm/react-dom/+esm"),[],import.meta.url),Ji=()=>f(()=>import("./tex-BE43Lb2g.js"),[],import.meta.url).then(e=>e.tex),Zi=()=>f(()=>import("https://cdn.jsdelivr.net/npm/topojson-client/+esm"),[],import.meta.url),Ki=()=>f(()=>import("./vega-lite-ClQwpDTB.js"),[],import.meta.url).then(e=>e.vl),Xi=Object.freeze(Object.defineProperty({__proto__:null,Arrow:Di,DuckDBClient:Bi,Inputs:qi,L:Vi,Plot:Ui,React:Gi,ReactDOM:Yi,_:Oi,aq:Ai,d3:Li,dot:Ri,duckdb:ki,echarts:Mi,htl:ji,html:Wi,mapboxgl:Fi,md:Hi,mermaid:zi,svg:Ni,tex:Ji,topojson:Zi,vl:Ki},Symbol.toStringTag,{value:"Module"}));Pe.resolve=it;function Pe(...e){return e.length===1?import(it(e[0])):Promise.all(e.map(t=>Pe(t))).then(t=>Object.assign({},...t))}function Qi(e){const t=e.split("/"),n=e.startsWith("@")?[t.shift(),t.shift()].join("/"):t.shift(),i=n.indexOf("@",1),r=i>0?n.slice(0,i):n,o=i>0?n.slice(i):"",a=t.length>0?`/${t.join("/")}`:"";return{name:r,range:o,path:a}}function it(e){const t=String(e);if(er(t)||tr(t))return t;const{name:n,range:i,path:r}=Qi(t);return`https://cdn.jsdelivr.net/npm/${n}${i}${r+(nr(r)||ir(r)?"":"/+esm")}`}function er(e){return/^\w+:/.test(e)}function tr(e){return/^(\.\/|\.\.\/|\/)/.test(e)}function nr(e){return/(\.\w*)$/.test(e)}function ir(e){return/(\/)$/.test(e)}const rr=()=>D(A("aapl.csv")),or=()=>D(A("alphabet.csv")),ar=()=>D(A("cars.csv")),sr=()=>D(A("citywages.csv")),ur=()=>D(A("diamonds.csv")),dr=()=>D(A("flare.csv")),lr=()=>D(A("industries.csv")),cr=()=>gr(A("miserables.json")),fr=()=>D(A("olympians.csv")),pr=()=>D(A("penguins.csv")),mr=()=>D(A("pizza.csv")),hr=()=>D(A("weather.csv"));function A(e){return`https://cdn.jsdelivr.net/npm/@observablehq/sample-datasets/${e}`}async function gr(e){const t=await fetch(e);if(!t.ok)throw new Error(`unable to fetch ${e}: status ${t.status}`);return t.json()}async function _r(e){const t=await fetch(e);if(!t.ok)throw new Error(`unable to fetch ${e}: status ${t.status}`);return t.text()}async function D(e,t){const[n,i]=await Promise.all([_r(e),f(()=>import("https://cdn.jsdelivr.net/npm/d3-dsv/+esm"),[],import.meta.url)]);return i.csvParse(n,i.autoType)}const yr=Object.freeze(Object.defineProperty({__proto__:null,aapl:rr,alphabet:or,cars:ar,citywages:sr,diamonds:ur,flare:dr,industries:lr,miserables:cr,olympians:fr,penguins:pr,pizza:mr,weather:hr},Symbol.toStringTag,{value:"Module"})),br=document.querySelector("main")??document.body,vr={now:()=>Ke(),width:()=>Xe(br),DatabaseClient:()=>Se,FileAttachment:()=>we,Generators:()=>ri,Interpreter:()=>nt,Mutable:()=>Qe,DOM:()=>Si,require:()=>Pe,__ojs_observer:()=>()=>new $i,...Xi,...yr};class wr{constructor(t=vr){Object.defineProperty(this,"runtime",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"main",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const n=new Ne({...t,__ojs_runtime:()=>n});this.runtime=Object.assign(n,{fileAttachments:di}),this.main=n.module()}define(t,n,i){ai(this.main,t,n,i)}}const se=new wr;se.runtime;const xr=se.main,_=se.define.bind(se);xr.constructor.prototype.defines=function(e){return this._scope.has(e)||this._builtins.has(e)||this._runtime._builtin._scope.has(e)};_({root:document.getElementById("cell-1"),expanded:[],variables:[]},{id:1,body:(e,t)=>{e(t`<style>
  /* Hide static image tables from API.md since we have live-computed versions */
  table:has(img[src^="images/"]) {
    display: none;
  }
</style>`)},inputs:["display","html"],outputs:[],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-2"),expanded:[],variables:[]},{id:2,body:(e,t)=>{const n=e`<a href="https://github.com/rreusser/webgpu-instanced-lines" target="_blank" style="
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 12px;
  background: #24292e;
  color: white;
  border-radius: 6px;
  text-decoration: none;
  font-size: 14px;
  font-weight: 500;
  float: right;
  margin: 0 0 10px 10px;
">
  <svg height="20" width="20" viewBox="0 0 16 16" fill="currentColor">
    <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
  </svg>
  View on GitHub
</a>`;return t(n),{link:n}},inputs:["html","display"],outputs:["link"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-4"),expanded:[],variables:[]},{id:4,body:async(e,t,n)=>{if(!navigator.gpu)throw e(t`<p style="color: red;">WebGPU is not supported in this browser.</p>`),new Error("WebGPU not supported");const i=await navigator.gpu.requestAdapter();if(!i)throw new Error("Failed to get WebGPU adapter");const r=await i.requestDevice(),o=navigator.gpu.getPreferredCanvasFormat();return n.then(()=>r.destroy()),{adapter:i,device:r,canvasFormat:o}},inputs:["display","html","invalidation"],outputs:["adapter","device","canvasFormat"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-5"),expanded:[],variables:[]},{id:5,body:async e=>{const{initDemoRenderer:t}=await f(async()=>{const{initDemoRenderer:i}=await import("./demo-renderer-Cg2IeOer.js");return{initDemoRenderer:i}},__vite__mapDeps([2,3]),import.meta.url).then(i=>{if(!("initDemoRenderer"in i))throw new SyntaxError("export 'initDemoRenderer' not found");return i}),n=await t();return e.then(()=>n.destroy()),{initDemoRenderer:t,demoRenderer:n}},inputs:["invalidation"],outputs:["initDemoRenderer","demoRenderer"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-7"),expanded:[],variables:[]},{id:7,body:async(e,t,n,i,r,o)=>{const[{createElementStack:a},{createZoomableAxes:s},{expandable:d}]=await Promise.all([f(()=>import("./element-stack-BU40TvN2.js"),[],import.meta.url).then(x=>{if(!("createElementStack"in x))throw new SyntaxError("export 'createElementStack' not found");return x}),f(()=>import("./zoomable-axes-BfGyq1bg.js"),[],import.meta.url).then(x=>{if(!("createZoomableAxes"in x))throw new SyntaxError("export 'createZoomableAxes' not found");return x}),f(()=>import("./expandable-goukRGI0.js"),[],import.meta.url).then(x=>{if(!("expandable"in x))throw new SyntaxError("export 'expandable' not found");return x})]),u=window.devicePixelRatio||1,l=Math.min(640,e),c=480,p=a({width:l,height:c,layers:[{id:"canvas",element:({current:x,width:g,height:w})=>{const m=x||document.createElement("canvas");return m.id="lines-canvas",m.width=Math.floor(g*u),m.height=Math.floor(w*u),m.style.width=`${g}px`,m.style.height=`${w}px`,m.style.border="1px solid rgba(0,0,0,0.2)",m}},{id:"svg",element:({current:x,width:g,height:w})=>(x?t.select(x):t.create("svg")).attr("width",g).attr("height",w).style("cursor","grab").node()}]}),h=p.elements.canvas,E=h.getContext("webgpu");E.configure({device:n,format:i,alphaMode:"premultiplied"});const y={dirty:!0},b=s({d3:t,element:p.elements.svg,xScale:t.scaleLinear().domain([-1,1]).range([0,l]),yScale:t.scaleLinear().domain([-1,1]).range([c,0]),aspectRatio:1,onChange:()=>{y.dirty=!0,p.dispatchEvent(new CustomEvent("update"))}}),v=r`<figure style="margin: 0;">
  ${p.element}
  <figcaption style="margin-top:5px">Drag handles to edit vertices. Drag background to pan, scroll to zoom.</figcaption>
</figure>`;return o(d(v,{width:l,height:c,controls:".lines-controls",onResize(x,g,w){p.resize(g,w),b.updateScales(t.scaleLinear().domain([-1,1]).range([0,g]),t.scaleLinear().domain([-1,1]).range([w,0])),y.dirty=!0,p.dispatchEvent(new CustomEvent("update"))}})),{createElementStack:a,createZoomableAxes:s,expandable:d,dpr:u,canvasWidth:l,canvasHeight:c,stack:p,canvas:h,gpuContext:E,renderState:y,axes:b,figure:v}},inputs:["width","d3","device","canvasFormat","html","display"],outputs:["createElementStack","createZoomableAxes","expandable","dpr","canvasWidth","canvasHeight","stack","canvas","gpuContext","renderState","axes","figure"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-8"),expanded:[],variables:[]},{id:8,body:(e,t)=>{const n=e.range([1,100],{label:"Line width",value:70,step:.5}),i=t(n),r=e.select(["bevel","miter","round"],{label:"Join type",value:"miter"}),o=t(r),a=e.select(["round","square","butt"],{label:"Cap type",value:"round"}),s=t(a),d=e.select(["wave","zigzag","spiral"],{label:"Pattern",value:"zigzag"}),u=t(d),l=e.range([0,50],{label:"SDF stroke width",value:10,step:.5}),c=t(l),p=e.range([0,1],{label:"Alpha",value:1,step:.01}),h=t(p),E=e.toggle({label:"Line break",value:!1}),y=t(E),b=e.toggle({label:"Stripes",value:!1}),v=t(b),x=e.toggle({label:"Varying width",value:!1}),g=t(x),w=e.toggle({label:"Debug view",value:"Debug view"}),m=t(w),S=e.toggle({label:"Depth test"}),C=t(S),P=e.toggle({label:"Cull back faces"}),I=t(P);return{lineWidthInput:n,lineWidth:i,joinTypeInput:r,joinType:o,capTypeInput:a,capType:s,patternInput:d,pattern:u,sdfStrokeWidthInput:l,sdfStrokeWidth:c,alphaInput:p,alpha:h,lineBreakInput:E,lineBreak:y,stripesInput:b,stripes:v,varyingWidthInput:x,varyingWidth:g,debugViewInput:w,debugView:m,depthTestInput:S,depthTest:C,cullBackFacesInput:P,cullBackFaces:I}},inputs:["Inputs","view"],outputs:["lineWidthInput","lineWidth","joinTypeInput","joinType","capTypeInput","capType","patternInput","pattern","sdfStrokeWidthInput","sdfStrokeWidth","alphaInput","alpha","lineBreakInput","lineBreak","stripesInput","stripes","varyingWidthInput","varyingWidth","debugViewInput","debugView","depthTestInput","depthTest","cullBackFacesInput","cullBackFaces"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-9"),expanded:[],variables:[]},{id:9,body:(e,t,n)=>{const i=e.range([1,10],{label:"Miter limit",value:4,step:.1,disabled:t!=="miter"}),r=n(i);return{miterLimitInput:i,miterLimit:r}},inputs:["Inputs","joinType","view"],outputs:["miterLimitInput","miterLimit"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-10"),expanded:[],variables:[]},{id:10,body:(e,t,n)=>{const i=e.range([2,16],{label:"Round join resolution",value:8,step:1,disabled:t!=="round"}),r=n(i);return{joinResolutionInput:i,joinResolution:r}},inputs:["Inputs","joinType","view"],outputs:["joinResolutionInput","joinResolution"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-11"),expanded:[],variables:[]},{id:11,body:(e,t,n)=>{const i=e.range([2,16],{label:"Round cap resolution",value:8,step:1,disabled:t!=="round"}),r=n(i),o=e.button("Download PNG"),a=n(o);return{capResolutionInput:i,capResolution:r,downloadButtonInput:o,downloadButton:a}},inputs:["Inputs","capType","view"],outputs:["capResolutionInput","capResolution","downloadButtonInput","downloadButton"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-12"),expanded:[],variables:[]},{id:12,body:(e,t,n,i,r,o,a,s,d,u,l,c,p,h,E,y,b,v)=>{e(t`<div class="lines-controls">
  ${n}
  ${i}
  ${r}
  ${o}
  ${a}
  ${s}
  ${d}
  ${u}
  ${l}
  ${c}
  ${p}
  ${h}
  ${E}
  ${y}
  ${b}
  ${v}
</div>`)},inputs:["display","html","lineWidthInput","joinTypeInput","capTypeInput","patternInput","miterLimitInput","joinResolutionInput","capResolutionInput","sdfStrokeWidthInput","alphaInput","lineBreakInput","stripesInput","varyingWidthInput","debugViewInput","depthTestInput","cullBackFacesInput","downloadButtonInput"],outputs:[],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-13"),expanded:[],variables:[]},{id:13,body:async(e,t,n,i,r,o)=>{const{createGPULines:a}=await f(async()=>{const{createGPULines:g}=await import("./webgpu-instanced-lines.esm-DUY4_7kn.js");return{createGPULines:g}},[],import.meta.url).then(g=>{if(!("createGPULines"in g))throw new SyntaxError("export 'createGPULines' not found");return g});function s(g,w){let m;if(g==="zigzag"){m=[];for(let C=0;C<6;C++){const I=-.6+C/5*1.2,$=C%2===0?.2:-.2;m.push({x:I,y:$,z:0,w:1})}}else if(g==="spiral"){m=[];for(let C=0;C<80;C++){const P=C/79,I=P*Math.PI*6,$=.1+P*.6;m.push({x:$*Math.cos(I),y:$*Math.sin(I),z:0,w:1})}}else{m=[];for(let C=0;C<100;C++){const P=C/99,I=-.8+P*1.6,$=.3*Math.sin(P*Math.PI*4)+.2*Math.cos(P*Math.PI*7);m.push({x:I,y:$,z:0,w:1})}}if(w){const S=Math.floor(m.length/2);m.splice(S,0,{x:0,y:0,z:0,w:0})}return m}const d=s(e,t),u=d.length;function l(g){const w=new Float32Array(g.length*4);for(let m=0;m<g.length;m++)w[m*4+0]=g[m].x,w[m*4+1]=g[m].y,w[m*4+2]=g[m].z,w[m*4+3]=g[m].w;return w}function c(g){const w=new Float32Array(g.length);let m=0;for(let S=0;S<g.length;S++){if(g[S].w===0)m=0;else if(S>0&&g[S-1].w!==0){const C=g[S].x-g[S-1].x,P=g[S].y-g[S-1].y;m+=Math.sqrt(C*C+P*P)}w[S]=m}return w}const p=l(d),h=c(d),E=Math.max(...h),y=n.createBuffer({label:"line-positions",size:p.byteLength,usage:i.STORAGE|i.COPY_DST});n.queue.writeBuffer(y,0,p);const b=n.createBuffer({label:"line-distances",size:h.byteLength,usage:i.STORAGE|i.COPY_DST});n.queue.writeBuffer(b,0,h);const v=n.createBuffer({label:"total-distance",size:4,usage:i.UNIFORM|i.COPY_DST});n.queue.writeBuffer(v,0,new Float32Array([E]));function x(){const g=l(d),w=c(d),m=Math.max(...w);n.queue.writeBuffer(y,0,g),n.queue.writeBuffer(b,0,w),n.queue.writeBuffer(v,0,new Float32Array([m])),r.dirty=!0}return o.then(()=>{y.destroy(),b.destroy(),v.destroy()}),{createGPULines:a,generatePattern:s,points:d,numPoints:u,pointsToFloat32Array:l,computeDistances:c,positions:p,distances:h,totalDistance:E,positionBuffer:y,distanceBuffer:b,totalDistanceBuffer:v,updateBuffers:x}},inputs:["pattern","lineBreak","device","GPUBufferUsage","renderState","invalidation"],outputs:["createGPULines","generatePattern","points","numPoints","pointsToFloat32Array","computeDistances","positions","distances","totalDistance","positionBuffer","distanceBuffer","totalDistanceBuffer","updateBuffers"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-14"),expanded:[],variables:[]},{id:14,body:(e,t,n,i,r)=>{const o=e.select(t.elements.svg),a=n.map((u,l)=>({point:u,index:l})).filter(u=>u.point.w!==0),s=o.selectAll("g.vertex-handle").data(a,u=>u.index).join("g").attr("class","vertex-handle").attr("cursor","move").call(e.drag().on("start",function(){e.select(this).select("circle.visible").attr("stroke","#0066cc").attr("stroke-width",2)}).on("drag",function(u,l){l.point.x=i.xScale.invert(u.x),l.point.y=i.yScale.invert(u.y),e.select(this).attr("transform",`translate(${u.x},${u.y})`),r()}).on("end",function(){e.select(this).select("circle.visible").attr("stroke","#333").attr("stroke-width",1.5)}));s.append("circle").attr("class","hit-area").attr("r",20).attr("fill","transparent"),s.append("circle").attr("class","visible").attr("r",5).attr("fill","white").attr("stroke","#333").attr("stroke-width",1.5).attr("pointer-events","none");function d(){s.attr("transform",u=>`translate(${i.xScale(u.point.x)},${i.yScale(u.point.y)})`)}return d(),t.addEventListener("update",d),{svg:o,editablePoints:a,handleGroups:s,updateHandlePositions:d}},inputs:["d3","stack","points","axes","updateBuffers"],outputs:["svg","editablePoints","handleGroups","updateHandlePositions"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-15"),expanded:[],variables:[]},{id:15,body:(e,t,n,i,r,o,a,s,d,u,l,c,p,h,E,y,b)=>{const v=n>0,x=v||i<1||a,g=s?"depth24plus":null,w=`
  @group(1) @binding(0) var<storage, read> positions: array<vec4f>;
  @group(1) @binding(1) var<storage, read> distances: array<f32>;
  @group(1) @binding(2) var<uniform> viewMatrix: mat4x4f;
  @group(1) @binding(3) var<uniform> totalDistance: f32;
  struct DebugUniforms {
    enabled: u32,
    dpr: f32,
  }
  @group(1) @binding(4) var<uniform> debug: DebugUniforms;
  @group(1) @binding(5) var<uniform> lineWidthUniform: f32;

  struct Vertex {
    position: vec4f,
    width: f32,
    dist: f32,      // cumulative distance along line
    lineWidth: f32, // interpolated width for fragment shader
  }

  fn getVertex(index: u32) -> Vertex {
    let p = positions[index];
    let d = distances[index];
    let projected = viewMatrix * vec4f(p.xyz, 1.0);
    // Reference totalDistance to ensure it's included in bind group layout
    let normalizedDist = d / totalDistance;
    let w = ${o?"lineWidthUniform * (0.5 + 1.5 * normalizedDist)":"lineWidthUniform"};
    return Vertex(vec4f(projected.xyz, p.w * projected.w), w, d, w);
  }
`,m=t==="square"?"max(abs(lineCoord.x), abs(lineCoord.y))":"length(lineCoord.xy)",S=`
  struct DebugUniforms {
    enabled: u32,
    dpr: f32,
  }
  @group(1) @binding(4) var<uniform> debug: DebugUniforms;

  fn linearstep(a: f32, b: f32, x: f32) -> f32 {
    return clamp((x - a) / (b - a), 0.0, 1.0);
  }

  // Unit grid lines for wireframe
  fn grid(parameter: vec3f, width: f32, feather: f32) -> f32 {
    let w1 = width - feather * 0.5;
    let d = fwidth(parameter);
    let looped = 0.5 - abs(parameter % 1.0 - 0.5);
    let a3 = smoothstep(d * w1, d * (w1 + feather), looped);
    return min(min(a3.x, a3.y), a3.z);
  }

  fn getColor(lineCoord: vec2f, dist: f32, lineWidth: f32, instanceID: f32, triStripCoord: vec2f) -> vec4f {
    let strokeWidth = ${n.toFixed(1)} * debug.dpr;
    let baseAlpha = ${i.toFixed(2)};

    // Compute SDF values
    let sdf = 0.5 * lineWidth * ${m};
    let aa = select(baseAlpha, linearstep(lineWidth * 0.5, lineWidth * 0.5 - 1.0, sdf) * baseAlpha, strokeWidth > 0.0);
    let strokeMask = select(0.0, linearstep(lineWidth * 0.5 - strokeWidth - 0.5, lineWidth * 0.5 - strokeWidth + 0.5, sdf), strokeWidth > 0.0);

    // Layer 1: Base fill color (debug instance color or normal color)
    var baseColor: vec3f;
    if (debug.enabled == 1u) {
      // instanceID encodes: non-negative = segment index, negative = cap with index (-id - 1)
      let isCap = instanceID < 0.0;
      let segmentIndex = select(instanceID, -instanceID - 1.0, isCap);
      let iSegmentIndex = i32(floor(segmentIndex + 0.5));
      baseColor = select(vec3f(0.8, 0.1, 0.4), vec3f(0.1, 0.7, 1.0), iSegmentIndex % 2 == 0);
    } else {
      baseColor = vec3f(0.1, 0.7, 1.0);
    }

    // Layer 2: Apply stripes on top of base color
    let stripeFreq = 20.0;
    let stripe = step(0.5, fract(dist * stripeFreq));
    let stripeColor = baseColor * 0.4;  // Darker version of base
    var color = ${r?"mix(baseColor, stripeColor, stripe)":"baseColor"};

    // Layer 3: Apply stroke (50% black in debug mode, dark blue in normal mode)
    color = mix(color, vec3f(0.0), strokeMask * 0.7);

    // Layer 4: Wireframe gridlines (debug only)
    if (debug.enabled == 1u) {
      let wire = grid(vec3f(triStripCoord, triStripCoord.x + triStripCoord.y), 0.5 * debug.dpr, 1.0);
      color = mix(vec3f(1.0), color, wire);
    }

    return vec4f(color, aa);
  }
`,C=x?{color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha",operation:"add"},alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"}}:void 0,P=u(l,{colorTargets:C?{format:c,blend:C}:{format:c},depthStencil:g?{format:g,depthWriteEnabled:!0,depthCompare:"less"}:void 0,primitive:{cullMode:d?"back":"none"},join:e,maxJoinResolution:16,maxCapResolution:16,cap:t,vertexShaderBody:w,fragmentShaderBody:S}),I=l.createBuffer({label:"view-matrix",size:64,usage:p.UNIFORM|p.COPY_DST}),$=l.createBuffer({label:"debug-uniform",size:8,usage:p.UNIFORM|p.COPY_DST}),N=l.createBuffer({label:"line-width-uniform",size:4,usage:p.UNIFORM|p.COPY_DST}),X=l.createBindGroup({layout:P.getBindGroupLayout(1),entries:[{binding:0,resource:{buffer:h}},{binding:1,resource:{buffer:E}},{binding:2,resource:{buffer:I}},{binding:3,resource:{buffer:y}},{binding:4,resource:{buffer:$}},{binding:5,resource:{buffer:N}}]});return b.then(()=>{P.destroy(),I.destroy(),N.destroy(),$.destroy()}),{useSdfMode:v,useBlend:x,depthFormat:g,vertexShaderBody:w,sdfDistFn:m,fragmentShaderBody:S,blend:C,gpuLines:P,viewMatrixBuffer:I,debugBuffer:$,lineWidthBuffer:N,dataBindGroup:X}},inputs:["joinType","capType","sdfStrokeWidth","alpha","stripes","varyingWidth","debugView","depthTest","cullBackFaces","createGPULines","device","canvasFormat","GPUBufferUsage","positionBuffer","distanceBuffer","totalDistanceBuffer","invalidation"],outputs:["useSdfMode","useBlend","depthFormat","vertexShaderBody","sdfDistFn","fragmentShaderBody","blend","gpuLines","viewMatrixBuffer","debugBuffer","lineWidthBuffer","dataBindGroup"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-16"),expanded:[],variables:[]},{id:16,body:async(e,t,n,i,r,o,a,s,d,u,l,c,p,h,E,y,b,v,x,g)=>{const{createFrameLoop:w}=await f(async()=>{const{createFrameLoop:I}=await import("./frame-loop-QkwpdSbZ.js");return{createFrameLoop:I}},[],import.meta.url).then(I=>{if(!("createFrameLoop"in I))throw new SyntaxError("export 'createFrameLoop' not found");return I});o.dirty=!0;let m=null,S=0,C=0;const P=w(()=>{if(o.dirty){a.queue.writeBuffer(s,0,d.view);const I=new ArrayBuffer(8);new Uint32Array(I,0,1)[0]=t?1:0,new Float32Array(I,4,1)[0]=u,a.queue.writeBuffer(l,0,I),a.queue.writeBuffer(c,0,new Float32Array([e*u])),p&&(!m||S!==h.width||C!==h.height)&&(m&&m.destroy(),m=a.createTexture({size:[h.width,h.height],format:p,usage:E.RENDER_ATTACHMENT}),S=h.width,C=h.height);const $=a.createCommandEncoder(),N={colorAttachments:[{view:y.getCurrentTexture().createView(),loadOp:"clear",storeOp:"store",clearValue:{r:0,g:0,b:0,a:0}}]};p&&m&&(N.depthStencilAttachment={view:m.createView(),depthClearValue:1,depthLoadOp:"clear",depthStoreOp:"store"});const X=$.beginRenderPass(N);b.draw(X,{vertexCount:v,resolution:[h.width,h.height],miterLimit:n,joinResolution:i,capResolution:r},[x]),X.end(),a.queue.submit([$.finish()]),o.dirty=!1}});return g.then(()=>{P.cancel(),m&&m.destroy()}),{createFrameLoop:w,depthTexture:m,depthTextureWidth:S,depthTextureHeight:C,loop:P}},inputs:["lineWidth","debugView","miterLimit","joinResolution","capResolution","renderState","device","viewMatrixBuffer","axes","dpr","debugBuffer","lineWidthBuffer","depthFormat","canvas","GPUTextureUsage","gpuContext","gpuLines","numPoints","dataBindGroup","invalidation"],outputs:["createFrameLoop","depthTexture","depthTextureWidth","depthTextureHeight","loop"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-17"),expanded:[],variables:[]},{id:17,body:async(e,t,n,i)=>{if(e>0){let r=function(a,s){const d=document.createElement("a");d.target="_blank",d.download=s,d.href=a,document.body.appendChild(d),d.click(),document.body.removeChild(d)};t.dirty=!0,await new Promise(a=>requestAnimationFrame(a)),await n.queue.onSubmittedWorkDone();const o=i.toDataURL("image/png");r(o,"webgpu-lines-demo.png")}},inputs:["downloadButton","renderState","device","canvas"],outputs:[],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-19"),expanded:[],variables:[]},{id:19,body:async(e,t)=>{const[{default:n},{getSectionWithHeading:i}]=await Promise.all([f(()=>import("./README-Scw22cUU.js"),[],import.meta.url).then(a=>{if(!("default"in a))throw new SyntaxError("export 'default' not found");return a}),f(()=>import("./markdown-sections-Dj22tHj4.js"),[],import.meta.url).then(a=>{if(!("getSectionWithHeading"in a))throw new SyntaxError("export 'getSectionWithHeading' not found");return a})]),r=i(n,"How It Works",2),o=`
### Line Breaks

To create a line break (splitting one line into multiple segments with separate end caps), have your \`getVertex\` function return a position with \`w = 0\` (or \`NaN\` in any component). The library detects these sentinel values and inserts caps on adjacent segments.

### Vertex Window

Internally, each instance calls \`getVertex\` for a 4-point window of adjacent vertices. Points **A** (previous) and **D** (next) provide direction for computing join angles. Points **B** (start) and **C** (end) define the segment being drawn.

Within each instance, a vertex index (0 to ~30, depending on join/cap resolution) expands into the triangle strip vertices. The vertex shader uses this index to compute screen-space offsets perpendicular to the line direction, forming the segment body, joins, and caps.
`;return e(t`${r}

${o}`),{readmeMd:n,getSectionWithHeading:i,howItWorks:r,additionalContent:o}},inputs:["display","md"],outputs:["readmeMd","getSectionWithHeading","howItWorks","additionalContent"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-20"),expanded:[],variables:[]},{id:20,body:async(e,t)=>{const[{default:n},{getSection:i,getSectionWithHeading:r}]=await Promise.all([f(()=>import("./API-Q-vU5d76.js"),[],import.meta.url).then(o=>{if(!("default"in o))throw new SyntaxError("export 'default' not found");return o}),f(()=>import("./markdown-sections-Dj22tHj4.js"),[],import.meta.url).then(o=>{if(!("getSection"in o))throw new SyntaxError("export 'getSection' not found");if(!("getSectionWithHeading"in o))throw new SyntaxError("export 'getSectionWithHeading' not found");return o})]);return e(t`---

## API Reference

### \`createGPULines(device, options)\`

${i(n,"`createGPULines(device, options)`")}

## Options
`),{apiMd:n,getSection:i,getSectionWithHeading:r}},inputs:["display","md"],outputs:["apiMd","getSection","getSectionWithHeading"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-21"),expanded:[],variables:[]},{id:21,body:async(e,t)=>{const[{default:n},{getSectionWithHeading:i}]=await Promise.all([f(()=>import("./API-Q-vU5d76.js"),[],import.meta.url).then(r=>{if(!("default"in r))throw new SyntaxError("export 'default' not found");return r}),f(()=>import("./markdown-sections-Dj22tHj4.js"),[],import.meta.url).then(r=>{if(!("getSectionWithHeading"in r))throw new SyntaxError("export 'getSectionWithHeading' not found");return r})]);return e(t`${i(n,"`join`")}`),{apiMd:n,getSectionWithHeading:i}},inputs:["display","md"],outputs:["apiMd","getSectionWithHeading"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-22"),expanded:[],variables:[]},{id:22,body:async(e,t,n)=>{{const i=(d,u=200,l=120)=>e`<canvas id="${d}" style="width: ${u}px; height: ${l}px; border: 1px solid #ddd;"></canvas>`,r=i("demo-join-bevel"),o=i("demo-join-miter"),a=i("demo-join-round");t(e`<div style="display: flex; flex-wrap: wrap; gap: 8px; justify-content: flex-start;">
    <figure style="margin: 0; text-align: center;">
      ${r}
      <figcaption><code>join: 'bevel'</code></figcaption>
    </figure>
    <figure style="margin: 0; text-align: center;">
      ${o}
      <figcaption><code>join: 'miter'</code></figcaption>
    </figure>
    <figure style="margin: 0; text-align: center;">
      ${a}
      <figcaption><code>join: 'round'</code></figcaption>
    </figure>
  </div>`);const s={pattern:"join-demo",lineWidth:50,cap:"round",miterLimit:10,width:200,height:120};await n.renderToCanvas(r,{...s,join:"bevel"}),await n.renderToCanvas(o,{...s,join:"miter"}),await n.renderToCanvas(a,{...s,join:"round"})}},inputs:["html","display","demoRenderer"],outputs:[],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-23"),expanded:[],variables:[]},{id:23,body:async(e,t)=>{const[{default:n},{getSectionWithHeading:i}]=await Promise.all([f(()=>import("./API-Q-vU5d76.js"),[],import.meta.url).then(r=>{if(!("default"in r))throw new SyntaxError("export 'default' not found");return r}),f(()=>import("./markdown-sections-Dj22tHj4.js"),[],import.meta.url).then(r=>{if(!("getSectionWithHeading"in r))throw new SyntaxError("export 'getSectionWithHeading' not found");return r})]);return e(t`${i(n,"`cap`")}`),{apiMd:n,getSectionWithHeading:i}},inputs:["display","md"],outputs:["apiMd","getSectionWithHeading"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-24"),expanded:[],variables:[]},{id:24,body:async(e,t,n)=>{{const i=(d,u=200,l=120)=>e`<canvas id="${d}" style="width: ${u}px; height: ${l}px; border: 1px solid #ddd;"></canvas>`,r=i("demo-cap-round"),o=i("demo-cap-square"),a=i("demo-cap-butt");t(e`<div style="display: flex; flex-wrap: wrap; gap: 8px; justify-content: flex-start;">
    <figure style="margin: 0; text-align: center;">
      ${r}
      <figcaption><code>cap: 'round'</code></figcaption>
    </figure>
    <figure style="margin: 0; text-align: center;">
      ${o}
      <figcaption><code>cap: 'square'</code></figcaption>
    </figure>
    <figure style="margin: 0; text-align: center;">
      ${a}
      <figcaption><code>cap: 'butt'</code></figcaption>
    </figure>
  </div>`);const s={pattern:"cap-demo",lineWidth:50,width:200,height:120};await n.renderToCanvas(r,{...s,cap:"round"}),await n.renderToCanvas(o,{...s,cap:"square"}),await n.renderToCanvas(a,{...s,cap:"butt"})}},inputs:["html","display","demoRenderer"],outputs:[],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-25"),expanded:[],variables:[]},{id:25,body:async(e,t)=>{const[{default:n},{getSectionWithHeading:i}]=await Promise.all([f(()=>import("./API-Q-vU5d76.js"),[],import.meta.url).then(r=>{if(!("default"in r))throw new SyntaxError("export 'default' not found");return r}),f(()=>import("./markdown-sections-Dj22tHj4.js"),[],import.meta.url).then(r=>{if(!("getSectionWithHeading"in r))throw new SyntaxError("export 'getSectionWithHeading' not found");return r})]);return e(t`${i(n,"`miterLimit`")}`),{apiMd:n,getSectionWithHeading:i}},inputs:["display","md"],outputs:["apiMd","getSectionWithHeading"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-26"),expanded:[],variables:[]},{id:26,body:async(e,t,n)=>{{const i=(d,u=200,l=120)=>e`<canvas id="${d}" style="width: ${u}px; height: ${l}px; border: 1px solid #ddd;"></canvas>`,r=i("demo-miter-1"),o=i("demo-miter-4"),a=i("demo-miter-10");t(e`<div style="display: flex; flex-wrap: wrap; gap: 8px; justify-content: flex-start;">
    <figure style="margin: 0; text-align: center;">
      ${r}
      <figcaption><code>miterLimit: 1</code></figcaption>
    </figure>
    <figure style="margin: 0; text-align: center;">
      ${o}
      <figcaption><code>miterLimit: 4</code></figcaption>
    </figure>
    <figure style="margin: 0; text-align: center;">
      ${a}
      <figcaption><code>miterLimit: 10</code></figcaption>
    </figure>
  </div>`);const s={pattern:"miter-demo",lineWidth:50,join:"miter",cap:"round",width:200,height:120};await n.renderToCanvas(r,{...s,miterLimit:1}),await n.renderToCanvas(o,{...s,miterLimit:4}),await n.renderToCanvas(a,{...s,miterLimit:10})}},inputs:["html","display","demoRenderer"],outputs:[],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-27"),expanded:[],variables:[]},{id:27,body:async(e,t)=>{const[{default:n},{getSectionWithHeading:i}]=await Promise.all([f(()=>import("./API-Q-vU5d76.js"),[],import.meta.url).then(r=>{if(!("default"in r))throw new SyntaxError("export 'default' not found");return r}),f(()=>import("./markdown-sections-Dj22tHj4.js"),[],import.meta.url).then(r=>{if(!("getSectionWithHeading"in r))throw new SyntaxError("export 'getSectionWithHeading' not found");return r})]);return e(t`${i(n,"`joinResolution` and `capResolution`")}`),{apiMd:n,getSectionWithHeading:i}},inputs:["display","md"],outputs:["apiMd","getSectionWithHeading"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-28"),expanded:[],variables:[]},{id:28,body:async(e,t,n)=>{{const i=(d,u=200,l=120)=>e`<canvas id="${d}" style="width: ${u}px; height: ${l}px; border: 1px solid #ddd;"></canvas>`,r=i("demo-res-2"),o=i("demo-res-4"),a=i("demo-res-16");t(e`<div style="display: flex; flex-wrap: wrap; gap: 8px; justify-content: flex-start;">
    <figure style="margin: 0; text-align: center;">
      ${r}
      <figcaption><code>joinResolution: 2</code></figcaption>
    </figure>
    <figure style="margin: 0; text-align: center;">
      ${o}
      <figcaption><code>joinResolution: 4</code></figcaption>
    </figure>
    <figure style="margin: 0; text-align: center;">
      ${a}
      <figcaption><code>joinResolution: 16</code></figcaption>
    </figure>
  </div>`);const s={pattern:"resolution-demo",lineWidth:50,join:"round",cap:"round",width:200,height:120};await n.renderToCanvas(r,{...s,joinResolution:2}),await n.renderToCanvas(o,{...s,joinResolution:4}),await n.renderToCanvas(a,{...s,joinResolution:16})}},inputs:["html","display","demoRenderer"],outputs:[],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-29"),expanded:[],variables:[]},{id:29,body:async(e,t)=>{const[{default:n},{getSectionWithHeading:i}]=await Promise.all([f(()=>import("./API-Q-vU5d76.js"),[],import.meta.url).then(r=>{if(!("default"in r))throw new SyntaxError("export 'default' not found");return r}),f(()=>import("./markdown-sections-Dj22tHj4.js"),[],import.meta.url).then(r=>{if(!("getSectionWithHeading"in r))throw new SyntaxError("export 'getSectionWithHeading' not found");return r})]);return e(t`${i(n,"Performance: Vertices Per Instance",3)}`),{apiMd:n,getSectionWithHeading:i}},inputs:["display","md"],outputs:["apiMd","getSectionWithHeading"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-30"),expanded:[],variables:[]},{id:30,body:async(e,t)=>{const[{default:n},{getSectionWithHeading:i}]=await Promise.all([f(()=>import("./API-Q-vU5d76.js"),[],import.meta.url).then(r=>{if(!("default"in r))throw new SyntaxError("export 'default' not found");return r}),f(()=>import("./markdown-sections-Dj22tHj4.js"),[],import.meta.url).then(r=>{if(!("getSectionWithHeading"in r))throw new SyntaxError("export 'getSectionWithHeading' not found");return r})]);return e(t`${i(n,"Line Breaks",3)}`),{apiMd:n,getSectionWithHeading:i}},inputs:["display","md"],outputs:["apiMd","getSectionWithHeading"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-31"),expanded:[],variables:[]},{id:31,body:async(e,t,n)=>{{const i=(s,d=200,u=120)=>e`<canvas id="${s}" style="width: ${d}px; height: ${u}px; border: 1px solid #ddd;"></canvas>`,r=i("demo-continuous"),o=i("demo-with-break");t(e`<div style="display: flex; flex-wrap: wrap; gap: 8px; justify-content: flex-start;">
    <figure style="margin: 0; text-align: center;">
      ${r}
      <figcaption>Continuous line</figcaption>
    </figure>
    <figure style="margin: 0; text-align: center;">
      ${o}
      <figcaption>With line break (<code>w: 0</code>)</figcaption>
    </figure>
  </div>`);const a={pattern:"break-demo",lineWidth:50,join:"round",cap:"round",width:200,height:120};await n.renderToCanvas(r,{...a,lineBreak:!1}),await n.renderToCanvas(o,{...a,lineBreak:!0})}},inputs:["html","display","demoRenderer"],outputs:[],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-32"),expanded:[],variables:[]},{id:32,body:async(e,t)=>{const[{default:n},{getSectionWithHeading:i}]=await Promise.all([f(()=>import("./API-Q-vU5d76.js"),[],import.meta.url).then(r=>{if(!("default"in r))throw new SyntaxError("export 'default' not found");return r}),f(()=>import("./markdown-sections-Dj22tHj4.js"),[],import.meta.url).then(r=>{if(!("getSectionWithHeading"in r))throw new SyntaxError("export 'getSectionWithHeading' not found");return r})]);return e(t`${i(n,"Drawing",2)}`),{apiMd:n,getSectionWithHeading:i}},inputs:["display","md"],outputs:["apiMd","getSectionWithHeading"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-33"),expanded:[],variables:[]},{id:33,body:async(e,t)=>{const[{default:n},{getSection:i}]=await Promise.all([f(()=>import("./API-Q-vU5d76.js"),[],import.meta.url).then(o=>{if(!("default"in o))throw new SyntaxError("export 'default' not found");return o}),f(()=>import("./markdown-sections-Dj22tHj4.js"),[],import.meta.url).then(o=>{if(!("getSection"in o))throw new SyntaxError("export 'getSection' not found");return o})]),r=i(n,"Custom Shaders",2).split(/^###/m)[0].trim();return e(t`---

## Custom Shaders

${r}
`),{apiMd:n,getSection:i,customShadersIntro:r}},inputs:["display","md"],outputs:["apiMd","getSection","customShadersIntro"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-34"),expanded:[],variables:[]},{id:34,body:async(e,t)=>{const[{default:n},{getSectionWithHeading:i}]=await Promise.all([f(()=>import("./API-Q-vU5d76.js"),[],import.meta.url).then(r=>{if(!("default"in r))throw new SyntaxError("export 'default' not found");return r}),f(()=>import("./markdown-sections-Dj22tHj4.js"),[],import.meta.url).then(r=>{if(!("getSectionWithHeading"in r))throw new SyntaxError("export 'getSectionWithHeading' not found");return r})]);return e(t`${i(n,"`vertexShaderBody`")}`),{apiMd:n,getSectionWithHeading:i}},inputs:["display","md"],outputs:["apiMd","getSectionWithHeading"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-35"),expanded:[],variables:[]},{id:35,body:async(e,t)=>{const[{default:n},{getSectionWithHeading:i}]=await Promise.all([f(()=>import("./API-Q-vU5d76.js"),[],import.meta.url).then(r=>{if(!("default"in r))throw new SyntaxError("export 'default' not found");return r}),f(()=>import("./markdown-sections-Dj22tHj4.js"),[],import.meta.url).then(r=>{if(!("getSectionWithHeading"in r))throw new SyntaxError("export 'getSectionWithHeading' not found");return r})]);return e(t`${i(n,"`fragmentShaderBody`")}`),{apiMd:n,getSectionWithHeading:i}},inputs:["display","md"],outputs:["apiMd","getSectionWithHeading"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-36"),expanded:[],variables:[]},{id:36,body:async(e,t)=>{const[{default:n},{getSectionWithHeading:i}]=await Promise.all([f(()=>import("./API-Q-vU5d76.js"),[],import.meta.url).then(r=>{if(!("default"in r))throw new SyntaxError("export 'default' not found");return r}),f(()=>import("./markdown-sections-Dj22tHj4.js"),[],import.meta.url).then(r=>{if(!("getSectionWithHeading"in r))throw new SyntaxError("export 'getSectionWithHeading' not found");return r})]);return e(t`${i(n,"`lineCoord` Values")}`),{apiMd:n,getSectionWithHeading:i}},inputs:["display","md"],outputs:["apiMd","getSectionWithHeading"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-37"),expanded:[],variables:[]},{id:37,body:async(e,t,n)=>{{const i=(u,l=200,c=120)=>e`<canvas id="${u}" style="width: ${l}px; height: ${c}px; border: 1px solid #ddd;"></canvas>`,r=i("demo-lc-x"),o=i("demo-lc-y");t(e`<div style="display: flex; flex-wrap: wrap; gap: 8px; justify-content: flex-start;">
    <figure style="margin: 0; max-width: 200px;">
      ${r}
      <figcaption><code>lineCoord.x</code> (0 on segments, varies in caps)</figcaption>
    </figure>
    <figure style="margin: 0; max-width: 200px;">
      ${o}
      <figcaption><code>lineCoord.y</code> (across line)</figcaption>
    </figure>
  </div>`);const a=`
    fn getColor(lineCoord: vec2f) -> vec4f {
      // lineCoord.x is 0 for segments, varies in caps (sin(theta))
      let t = abs(lineCoord.x);
      // Blue for segments (x=0), orange gradient in caps
      return vec4f(t, 0.4 * (1.0 - t), 1.0 - t, 1.0);
    }
  `,s=`
    fn getColor(lineCoord: vec2f) -> vec4f {
      let t = lineCoord.y * 0.5 + 0.5;
      return vec4f(t, 0.3, 1.0 - t, 1.0);
    }
  `,d={pattern:"cap-demo",lineWidth:50,join:"round",cap:"round",width:200,height:120};await n.renderToCanvas(r,{...d,fragmentShaderBody:a}),await n.renderToCanvas(o,{...d,fragmentShaderBody:s})}},inputs:["html","display","demoRenderer"],outputs:[],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-38"),expanded:[],variables:[]},{id:38,body:async(e,t)=>{const[{default:n},{getSectionWithHeading:i}]=await Promise.all([f(()=>import("./API-Q-vU5d76.js"),[],import.meta.url).then(r=>{if(!("default"in r))throw new SyntaxError("export 'default' not found");return r}),f(()=>import("./markdown-sections-Dj22tHj4.js"),[],import.meta.url).then(r=>{if(!("getSectionWithHeading"in r))throw new SyntaxError("export 'getSectionWithHeading' not found");return r})]);return e(t`${i(n,"Example Shaders")}`),{apiMd:n,getSectionWithHeading:i}},inputs:["display","md"],outputs:["apiMd","getSectionWithHeading"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-39"),expanded:[],variables:[]},{id:39,body:async(e,t,n)=>{{const i=(p,h=200,E=120)=>e`<canvas id="${p}" style="width: ${h}px; height: ${E}px; border: 1px solid #ddd;"></canvas>`,r=i("demo-stripes"),o=i("demo-gradient"),a=i("demo-sdf-stroke");t(e`<div style="display: flex; flex-wrap: wrap; gap: 8px; justify-content: flex-start;">
    <figure style="margin: 0; text-align: center;">
      ${r}
      <figcaption>Cross-line stripes</figcaption>
    </figure>
    <figure style="margin: 0; text-align: center;">
      ${o}
      <figcaption>Cross-line gradient</figcaption>
    </figure>
    <figure style="margin: 0; text-align: center;">
      ${a}
      <figcaption>SDF stroke</figcaption>
    </figure>
  </div>`);const s=`
    fn getColor(lineCoord: vec2f) -> vec4f {
      // Cross-line stripes using lineCoord.y
      let stripe = select(0.0, 1.0, lineCoord.y >= 0.0);
      return vec4f(stripe * 0.2, 0.5, 0.9 - stripe * 0.4, 1.0);
    }
  `,d=`
    fn getColor(lineCoord: vec2f) -> vec4f {
      let t = lineCoord.y * 0.5 + 0.5;
      let top = vec3f(1.0, 0.4, 0.2);
      let bottom = vec3f(0.2, 0.4, 1.0);
      let color = mix(bottom, top, t);
      return vec4f(color, 1.0);
    }
  `,u=`
    fn linearstep(a: f32, b: f32, x: f32) -> f32 {
      return clamp((x - a) / (b - a), 0.0, 1.0);
    }
    fn getColor(lineCoord: vec2f) -> vec4f {
      let width = 50.0;
      let strokeWidth = 5.0;
      // Use length(lineCoord) for proper SDF on both segments and caps
      let dist = length(lineCoord);
      let sdf = 0.5 * width * dist;
      let aa = linearstep(width * 0.5, width * 0.5 - 1.0, sdf);
      let strokeMask = linearstep(width * 0.5 - strokeWidth - 0.5, width * 0.5 - strokeWidth + 0.5, sdf);
      let fillColor = vec3f(0.4, 0.7, 1.0);
      let strokeColor = vec3f(0.1, 0.3, 0.6);
      let color = mix(fillColor, strokeColor, strokeMask);
      return vec4f(color, aa);
    }
  `,l={color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha",operation:"add"},alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"}},c={pattern:"shader-demo",join:"round",cap:"round",width:200,height:120};await n.renderToCanvas(r,{...c,lineWidth:50,fragmentShaderBody:s}),await n.renderToCanvas(o,{...c,lineWidth:50,fragmentShaderBody:d}),await n.renderToCanvas(a,{...c,lineWidth:50,fragmentShaderBody:u,blend:l})}},inputs:["html","display","demoRenderer"],outputs:[],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});_({root:document.getElementById("cell-41"),expanded:[],variables:[]},{id:41,body:(e,t)=>{function n(o,a){const s=document.createElement("a");s.target="_blank",s.download=a,s.href=o,document.body.appendChild(s),s.click(),document.body.removeChild(s)}function i(){const o=document.querySelectorAll('canvas[id^="demo-"]');Array.from(o).forEach((a,s)=>{setTimeout(()=>{const d=a.toDataURL("image/png"),u=a.id.replace("demo-","")+".png";n(d,u)},s*300)})}const r=e`<button style="padding: 8px 16px; cursor: pointer;">Download All Demo Images</button>`;return r.onclick=i,t(r),{downloadURI:n,downloadAllImages:i,btn:r}},inputs:["html","display"],outputs:["downloadURI","downloadAllImages","btn"],output:void 0,assets:void 0,autodisplay:!1,autoview:void 0,automutable:void 0});export{f as _};
