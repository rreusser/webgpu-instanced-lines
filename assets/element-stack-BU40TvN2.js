function u({container:e=document.createElement("div"),width:p=100,height:m=100,layers:r=[]}={}){e.style.position="relative",e.style.width=`${p}px`,e.style.height=`${m}px`,e._width=p,e._height=m,e._layerOrder=r.map(t=>t.id),e._layerDefs=Object.fromEntries(r.map(t=>[t.id,t.element])),e._elements=e._elements||{};const f=e._elements;function h(t,l={}){const _=e._layerDefs[t];if(!_)return null;const d=f[t]||null,s=_({current:d,width:e._width,height:e._height,...l});return s.setAttribute("data-layer",t),s.style.position||(s.style.position="absolute"),s.style.top||(s.style.top="0"),s.style.left||(s.style.left="0"),d&&d!==s?d.replaceWith(s):d||e.appendChild(s),f[t]=s,s}for(const t of e._layerOrder)h(t);if(!e._stack)e._stack={get element(){return e},get width(){return e._width},get height(){return e._height},get elements(){return f},update(...t){for(const l of t)h(l);return e.dispatchEvent(new CustomEvent("update")),e._stack},resize(t,l){e._width=t,e._height=l,e.style.width=`${t}px`,e.style.height=`${l}px`;for(const _ of e._layerOrder)h(_);return e.dispatchEvent(new CustomEvent("update")),e._stack},addEventListener:(...t)=>e.addEventListener(...t),removeEventListener:(...t)=>e.removeEventListener(...t),dispatchEvent:(...t)=>e.dispatchEvent(...t)};else{e._layerOrder=r.map(t=>t.id),e._layerDefs=Object.fromEntries(r.map(t=>[t.id,t.element]));for(const t of e._layerOrder)h(t)}return e._stack}export{u as createElementStack};
